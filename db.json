{"meta":{"version":1,"warehouse":"4.0.1"},"models":{"Asset":[{"_id":"themes/landscape/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/kr-color-dark.min.css","path":"css/kr-color-dark.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/kratosr.min.css","path":"css/kratosr.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/prismjs.min.css","path":"css/prismjs.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/404.webp","path":"images/404.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/about.webp","path":"images/about.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/alipay.webp","path":"images/alipay.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/avatar.webp","path":"images/avatar.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/banner.webp","path":"images/banner.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/banner_dark.webp","path":"images/banner_dark.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/bg.webp","path":"images/bg.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/bg_dark.webp","path":"images/bg_dark.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/comment.webp","path":"images/comment.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/comment_dark.webp","path":"images/comment_dark.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/failure.ico","path":"images/failure.ico","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/psr.webp","path":"images/psr.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/wechat.webp","path":"images/wechat.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/candy.min.js","path":"js/candy.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/kr-dark.min.js","path":"js/kr-dark.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/kratosr.min.js","path":"js/kratosr.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/local-search.min.js","path":"js/local-search.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/pjax.min.js","path":"js/pjax.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/snow.min.js","path":"js/snow.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/light.min.css","path":"css/highlight/light.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-blue.min.css","path":"css/highlight/night-blue.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-bright.min.css","path":"css/highlight/night-bright.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-eighties.min.css","path":"css/highlight/night-eighties.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night.min.css","path":"css/highlight/night.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_1.webp","path":"images/thumb/thumb_1.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_10.webp","path":"images/thumb/thumb_10.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_11.webp","path":"images/thumb/thumb_11.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_12.webp","path":"images/thumb/thumb_12.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_13.webp","path":"images/thumb/thumb_13.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_14.webp","path":"images/thumb/thumb_14.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_15.webp","path":"images/thumb/thumb_15.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_16.webp","path":"images/thumb/thumb_16.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_17.webp","path":"images/thumb/thumb_17.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_18.webp","path":"images/thumb/thumb_18.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_19.webp","path":"images/thumb/thumb_19.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_2.webp","path":"images/thumb/thumb_2.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_20.webp","path":"images/thumb/thumb_20.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_3.webp","path":"images/thumb/thumb_3.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_4.webp","path":"images/thumb/thumb_4.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_5.webp","path":"images/thumb/thumb_5.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_6.webp","path":"images/thumb/thumb_6.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_7.webp","path":"images/thumb/thumb_7.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_8.webp","path":"images/thumb/thumb_8.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_9.webp","path":"images/thumb/thumb_9.webp","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/rin.jpg","path":"images/rin.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/hello-world.md","hash":"7d98d6592de80fdcd2949bd7401cec12afd98cdf","modified":1655537987848},{"_id":"themes/landscape/.npmignore","hash":"58d26d4b5f2f94c2d02a4e4a448088e4a2527c77","modified":1655537987846},{"_id":"themes/landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1655537987847},{"_id":"themes/landscape/Gruntfile.js","hash":"71adaeaac1f3cc56e36c49d549b8d8a72235c9b9","modified":1655537987847},{"_id":"themes/landscape/_config.yml","hash":"79ac6b9ed6a4de5a21ea53fc3f5a3de92e2475ff","modified":1655537987847},{"_id":"themes/landscape/README.md","hash":"37fae88639ef60d63bd0de22314d7cc4c5d94b07","modified":1655537987847},{"_id":"themes/landscape/languages/de.yml","hash":"3ebf0775abbee928c8d7bda943c191d166ded0d3","modified":1655537987847},{"_id":"themes/landscape/package.json","hash":"544f21a0b2c7034998b36ae94dba6e3e0f39f228","modified":1655537987847},{"_id":"themes/landscape/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1655537987848},{"_id":"themes/landscape/languages/es.yml","hash":"76edb1171b86532ef12cfd15f5f2c1ac3949f061","modified":1655537987848},{"_id":"themes/landscape/languages/fr.yml","hash":"415e1c580ced8e4ce20b3b0aeedc3610341c76fb","modified":1655537987849},{"_id":"themes/landscape/languages/ja.yml","hash":"a73e1b9c80fd6e930e2628b393bfe3fb716a21a9","modified":1655537987848},{"_id":"themes/landscape/languages/ko.yml","hash":"881d6a0a101706e0452af81c580218e0bfddd9cf","modified":1655537987849},{"_id":"themes/landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1655537987849},{"_id":"themes/landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1655537987849},{"_id":"themes/landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1655537987849},{"_id":"themes/landscape/languages/pt.yml","hash":"57d07b75d434fbfc33b0ddb543021cb5f53318a8","modified":1655537987849},{"_id":"themes/landscape/languages/zh-CN.yml","hash":"ca40697097ab0b3672a80b455d3f4081292d1eed","modified":1655537987849},{"_id":"themes/landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1655537987849},{"_id":"themes/landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1655537987847},{"_id":"themes/landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1655537987849},{"_id":"themes/landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1655537987849},{"_id":"themes/landscape/layout/layout.ejs","hash":"f155824ca6130080bb057fa3e868a743c69c4cf5","modified":1655537987849},{"_id":"themes/landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1655537987849},{"_id":"themes/landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1655537987849},{"_id":"themes/landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1655537987849},{"_id":"themes/landscape/scripts/fancybox.js","hash":"aa411cd072399df1ddc8e2181a3204678a5177d9","modified":1655537987847},{"_id":"themes/landscape/layout/_partial/after-footer.ejs","hash":"d0d753d39038284d52b10e5075979cc97db9cd20","modified":1655537987849},{"_id":"themes/landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1655537987850},{"_id":"themes/landscape/layout/_partial/archive.ejs","hash":"950ddd91db8718153b329b96dc14439ab8463ba5","modified":1655537987850},{"_id":"themes/landscape/layout/_partial/footer.ejs","hash":"93518893cf91287e797ebac543c560e2a63b8d0e","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/gauges-analytics.ejs","hash":"aad6312ac197d6c5aaf2104ac863d7eba46b772a","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/article.ejs","hash":"c4c835615d96a950d51fa2c3b5d64d0596534fed","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/head.ejs","hash":"5abf77aec957d9445fc71a8310252f0013c84578","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/header.ejs","hash":"7e749050be126eadbc42decfbea75124ae430413","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1655537987851},{"_id":"themes/landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1655537987849},{"_id":"themes/landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1655537987851},{"_id":"themes/landscape/layout/_widget/recent_posts.ejs","hash":"0d4f064733f8b9e45c0ce131fe4a689d570c883a","modified":1655537987851},{"_id":"themes/landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1655537987851},{"_id":"themes/landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1655537987851},{"_id":"themes/landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1655537987852},{"_id":"themes/landscape/source/css/_variables.styl","hash":"628e307579ea46b5928424313993f17b8d729e92","modified":1655537987853},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1655537987851},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1655537987851},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1655537987851},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1655537987852},{"_id":"themes/landscape/source/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1655537987851},{"_id":"themes/landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1655537987852},{"_id":"themes/landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1655537987852},{"_id":"themes/landscape/layout/_partial/post/date.ejs","hash":"6197802873157656e3077c5099a7dda3d3b01c29","modified":1655537987852},{"_id":"themes/landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1655537987852},{"_id":"themes/landscape/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1655537987852},{"_id":"themes/landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1655537987852},{"_id":"themes/landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1655537987853},{"_id":"themes/landscape/source/css/_partial/article.styl","hash":"10685f8787a79f79c9a26c2f943253450c498e3e","modified":1655537987853},{"_id":"themes/landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1655537987853},{"_id":"themes/landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1655537987854},{"_id":"themes/landscape/source/css/_partial/header.styl","hash":"85ab11e082f4dd86dde72bed653d57ec5381f30c","modified":1655537987853},{"_id":"themes/landscape/source/css/_partial/highlight.styl","hash":"bf4e7be1968dad495b04e83c95eac14c4d0ad7c0","modified":1655537987854},{"_id":"themes/landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1655537987854},{"_id":"themes/landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1655537987854},{"_id":"themes/landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1655537987854},{"_id":"themes/landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1655537987854},{"_id":"themes/landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1655537987853},{"_id":"themes/landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1655537987854},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1655537987853},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1655537987855},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1655537987855},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1655537987852},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1655537987853},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1655537987853},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1655537987853},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1655537987853},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1655537987853},{"_id":"themes/landscape/source/css/style.styl","hash":"a70d9c44dac348d742702f6ba87e5bb3084d65db","modified":1655537987853},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1655537987855},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1655537987855},{"_id":"themes/landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1655537987853},{"_id":"public/2022/06/18/hello-world/index.html","hash":"1563978d2f0ea722cfcd3fd194224b652746680b","modified":1655542362412},{"_id":"public/archives/index.html","hash":"e49c816912e4ae92504c31712eed009f107ad395","modified":1655542362412},{"_id":"public/archives/2022/index.html","hash":"d06c602f0361d85059c8c9d52bf2751722c77db8","modified":1655542362412},{"_id":"public/archives/2022/06/index.html","hash":"d731dbab04a1c00a2f3fb74a35e3518cdf59c8aa","modified":1655542362412},{"_id":"public/index.html","hash":"b13d78351380c82e34b58d932feb96e8e64683e8","modified":1655542362412},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1655542362412},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1655542362412},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1655542362412},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1655542362412},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1655542362412},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1655542362412},{"_id":"public/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1655542362412},{"_id":"public/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1655542362412},{"_id":"public/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1655542362412},{"_id":"public/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1655542362412},{"_id":"public/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1655542362412},{"_id":"public/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1655542362412},{"_id":"public/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1655542362412},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1655542362412},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1655542362412},{"_id":"public/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1655542362412},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1655542362412},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1655542362412},{"_id":"public/css/style.css","hash":"3986ef4b1f56bf0ac3bc45aab261e0278794c3f1","modified":1655542362412},{"_id":"public/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1655542362412},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1655542362412},{"_id":"public/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1655542362412},{"_id":"public/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1655542362412},{"_id":"node_modules/hexo-theme-kratos-rebirth/Kratos-Rebirth-Manual.md","hash":"375cc19736c43e4642e3a83a6689eadf87eab8f2","modified":1655551189918},{"_id":"node_modules/hexo-theme-kratos-rebirth/ReadMe.md","hash":"b07f349495c3351002141650bbb8db33c3e20563","modified":1655551189922},{"_id":"node_modules/hexo-theme-kratos-rebirth/_config.yml","hash":"767441c8614d03f612e5972a7fe1c04d4785ead2","modified":1655551190481},{"_id":"node_modules/hexo-theme-kratos-rebirth/gulpfile.js","hash":"7d48d25a9520467cb26a34bac9222484f466f70d","modified":1655551189872},{"_id":"node_modules/hexo-theme-kratos-rebirth/LICENSE","hash":"31a3d460bb3c7d98845187c716a30db81c44b615","modified":1655551189771},{"_id":"node_modules/hexo-theme-kratos-rebirth/package.json","hash":"67b060ff1b3a2efa3d8eb9341aa53cc58f4f3f3c","modified":1655551189877},{"_id":"node_modules/hexo-theme-kratos-rebirth/.demo/_config.kratos-rebirth.yml","hash":"00af643896ab408bd51c11c9dbd3235b211dba9c","modified":1655551190481},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/FUNDING.yml","hash":"034eaa235c5cc18532e09e24106120d711af0320","modified":1655551190487},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/dependabot.yml","hash":"89c16d0b45677ff20b86b655e3bfc7f1e675b2d4","modified":1655551190487},{"_id":"node_modules/hexo-theme-kratos-rebirth/languages/zh-CN.yml","hash":"dd90a41359f905eff283cea51dc76c0bd7a044e8","modified":1655551190488},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/category.ejs","hash":"5677b70953e6a33038a0e03eaa06e45c10ec7d73","modified":1655551189803},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/archive.ejs","hash":"6dec1243c2d76a415d2fa5766ab184652c90c18c","modified":1655551189796},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/layout.ejs","hash":"ea86e5b8f64957145ff52f5e2660e62ff92e0b05","modified":1655551189828},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/page.ejs","hash":"4593e0a73b36b34dce40e3fbfe4c8056a7c9eb8f","modified":1655551189840},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/post.ejs","hash":"8a2ca2fc1bb8f51f444fa48eb86fa3b236e99254","modified":1655551189848},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/index.ejs","hash":"9c537b1958c8d67adb21afc46393f782973096f9","modified":1655551189827},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/additional-pages.js","hash":"fc0c9c40c39f2365bad5e1ae0818b1ffea567c33","modified":1655551189864},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/tag.ejs","hash":"5677b70953e6a33038a0e03eaa06e45c10ec7d73","modified":1655551189853},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/cdn-optimize-helpers.js","hash":"39bf53c96dec666c344f34b0e9f0e1e3b6c41340","modified":1655551189865},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/check-update.js","hash":"fcadb1499a85d427d5b80fc6c64eab61ca999925","modified":1655551189867},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/friends.js","hash":"480fbe09d997828d89845a6a6f6444eef2930702","modified":1655551189870},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/genconfig.js","hash":"f191f314da414f1013cac3d17de677a7fe8a423c","modified":1655551189872},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/search.js","hash":"6d7aa8f7913b549e3935ec7775f1ebba720d31b1","modified":1655551189875},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/tag-widgets.js","hash":"78d14c05c6205762f73ad3df420d9c6e78b9cd4e","modified":1655551189876},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/ISSUE_TEMPLATE/feature_request.md","hash":"40e561f1af41b0b88d146ec1ea62d7eabda3e890","modified":1655551189878},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/ISSUE_TEMPLATE/bug_report.md","hash":"410f2b7b788f86585451c7f351245e4d51a87f91","modified":1655551189878},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/workflows/auto-release.yml","hash":"bb8f12db86ed191d831ef4036afeb047a41dce85","modified":1655551190483},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/workflows/build-demo.yml","hash":"a9db5770d0840e4d3072c1de70505be07339b7f5","modified":1655551190484},{"_id":"node_modules/hexo-theme-kratos-rebirth/.github/workflows/build-test.yml","hash":"48c7ea4599e99b3df2af4fc274c30687a0fdd76e","modified":1655551190485},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/disqusjs.ejs","hash":"ff26cf5f07968e29a167ef9e8b02a4f8083105ab","modified":1655551189806},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/disqus.ejs","hash":"38a80a494e861be233b145675696ad9699aeeba0","modified":1655551189804},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/gitalk.ejs","hash":"c8410cac684322c5a8c2ce019d437683005a9923","modified":1655551189810},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/gitment.ejs","hash":"fbb446c214d89db0a12883751e3625de63b2997a","modified":1655551189812},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/livere.ejs","hash":"21dc5bc91d73b54b06ac36669eefd5258b07e83e","modified":1655551189835},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/twikoo.ejs","hash":"3e44152bc7b037df3c3fc541cc5c162c2dea1f01","modified":1655551189861},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/valine.ejs","hash":"eef355d2adf03b216337401db6efc74e86f620db","modified":1655551189861},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_comments/waline.ejs","hash":"afe4b832d16bebc9e497b4efb28a74ae8fbcd885","modified":1655551189862},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_pages/404.ejs","hash":"5a074196d0d2adb6f50af1f0ea602a45c81e1f7a","modified":1655551189784},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_pages/categories.ejs","hash":"39a1c79de03dbc8295c9da59cebec15ae30dd632","modified":1655551189801},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_pages/tags.ejs","hash":"70b9ce41a0e149e60788ac6d16864fea5b3311e3","modified":1655551189856},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_pages/search-page.ejs","hash":"e56bc1bb3c2de4526e4ea9738a4d80bcf63f51c3","modified":1655551189851},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_partial/after-footer.ejs","hash":"7d6a853c2d4012d51a71fa50cae73a733d311968","modified":1655551189791},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_partial/footer.ejs","hash":"e1a02605474caa01de75ca58805f4ca3f931226f","modified":1655551189809},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_plugins/mermaid.ejs","hash":"e233aa575aa61260bd68a6aa6275184006310726","modified":1655551189837},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_partial/header.ejs","hash":"367fe75833ad2684ec631eb71b4308fa2cb101c8","modified":1655551189822},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_tools/player.ejs","hash":"bbc560b6f2c6842bfce5248ca322fd879b625f87","modified":1655551189842},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_partial/sidebar.ejs","hash":"c34bd43af8b719d8444ccea4dd9bd173b01a024e","modified":1655551189853},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_widget/about.ejs","hash":"c1d3437dc3d5e70e6beca9fbfea5a9766b7e7ee2","modified":1655551189784},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_widget/category.ejs","hash":"1f24ccfd175fabc83c7ea81f3412e78e65b8f3ab","modified":1655551189802},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_widget/posts.ejs","hash":"43461f2e3cb32b9092dcd9a977098ff8be6a3f68","modified":1655551189850},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_widget/tagcloud.ejs","hash":"223730bfe007f26d5279cb66f1da9222c7d64c62","modified":1655551189853},{"_id":"node_modules/hexo-theme-kratos-rebirth/scripts/lib/cdn.js","hash":"7a4062fc76ee08de3fe950d77a4860185c633563","modified":1655551189866},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/kr-color-dark.min.css","hash":"92a814c3fd3a954f77f0943f936dcf3b095f706f","modified":1655551189774},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/prismjs.min.css","hash":"94df0fe6c26d18a094c54c30283d65c3659ccf7a","modified":1655551189783},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/kratosr.min.css","hash":"7cf878dee786164d1afa3ec6096e22ac209d1ebe","modified":1655551189776},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/404.webp","hash":"d2e2bd5cc2627a2b04d5e449a67949a2605ae13e","modified":1655551189937},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/about.webp","hash":"ca0fb739ab4426e7895742c1d8d52df1e14468e8","modified":1655551189938},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/alipay.webp","hash":"01fa6151d2122f0470ee6f38ac8e4ced6c81912e","modified":1655551189939},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/avatar.webp","hash":"3ed6e4e1e08e9c2700aa149d1f9e068fb02947cd","modified":1655551189942},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/banner.webp","hash":"7c5093243bfd581a633ba8a905e2d379cfa78c00","modified":1655551190110},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/banner_dark.webp","hash":"5589986444825e2b75c369d419ff736d3a396bac","modified":1655551190101},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/bg.webp","hash":"f232b442b64eaa90f45a48ff04d8e7d352caf212","modified":1655551190124},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/bg_dark.webp","hash":"f232b442b64eaa90f45a48ff04d8e7d352caf212","modified":1655551190116},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/comment.webp","hash":"7756b5a69f2a85a2d1c4251e3055bfa0218aa385","modified":1655551190126},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/comment_dark.webp","hash":"7756b5a69f2a85a2d1c4251e3055bfa0218aa385","modified":1655551190125},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_partial/head.ejs","hash":"2efb85990bc01838d1773dcc199595412c4cb86a","modified":1655551189821},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/failure.ico","hash":"5eec5c163400d8ece74286da49130da1ead3f6f6","modified":1655551189863},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/psr.webp","hash":"bf457bf84bca767bac1bd2b960d91c53ba3fbdee","modified":1655551190269},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/wechat.webp","hash":"06f3997bf554768c04cb588198c7b3d68c21b8e9","modified":1655551190480},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/candy.min.js","hash":"68557657a90856086aaeaeeeeed768aa1e27d73e","modified":1655551189865},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/kr-dark.min.js","hash":"dc01e4d5e7863537fcf5c6ee240895253e238f37","modified":1655551189873},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/kratosr.min.js","hash":"90466b6ea56190e269f3e89703dc366570b60598","modified":1655551189874},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/local-search.min.js","hash":"9e60a349fe6bc9b0046f99f31aac125d0d66c1c3","modified":1655551189874},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/pjax.min.js","hash":"49b491877a535d444875fcabe242654f47fc9082","modified":1655551189875},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/js/snow.min.js","hash":"0512232ec3bc342ff998abbebe5604cd73ef8b04","modified":1655551189876},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/light.min.css","hash":"c42fa620f43eaafa550bc68a7e69e6e34ada0032","modified":1655551189779},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-blue.min.css","hash":"3a02ca54dd6a7ca6a8deb10012b5604653e398c6","modified":1655551189780},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-bright.min.css","hash":"9a3a66fa13f93d5196b67e8cac24b2aac4165a2c","modified":1655551189780},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night-eighties.min.css","hash":"c3731f78911a97ed001500796a6e8d4ee9a78ab5","modified":1655551189781},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/css/highlight/night.min.css","hash":"6413d0664d104edd739554011c75b5a02b9f5fde","modified":1655551189781},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_1.webp","hash":"a818f050112ceb75e3a60dc1673a10783b254595","modified":1655551190274},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_10.webp","hash":"4983eeca7886bbe7c09b0c79f4774302fdfa1315","modified":1655551190279},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_12.webp","hash":"b6b8e1281f9146925e45e937cb4d5b28bcabe957","modified":1655551190287},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_11.webp","hash":"08d8d91e2b01768842abb47cd48a0f07d22d070c","modified":1655551190282},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_13.webp","hash":"c4c9050637f4ffa3cb7d782f59dadc993ac3a6de","modified":1655551190291},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_14.webp","hash":"f9300e2b45c1f061ec8cc21527142dafc558a9e6","modified":1655551190298},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_15.webp","hash":"8629f2a7d3b0192549f809e6b7479159af0222da","modified":1655551190304},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_16.webp","hash":"61714ccffd55d6fa74cf94bcdd5a464da04ce891","modified":1655551190309},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_17.webp","hash":"b5a036ec234a23c820a89d1c640b1f2e8dd3dfa4","modified":1655551190313},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_18.webp","hash":"5bc78b9d6cb0a0cf6daa3a35b93e575777a49ddd","modified":1655551190315},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_19.webp","hash":"15e0cd0cbe5c7166915a4b68680681beccc2afef","modified":1655551190318},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_2.webp","hash":"1bcf7461c2b9408b8a893013fa425eb46701faf6","modified":1655551190321},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_20.webp","hash":"4ab961d94a0d3abbefc7f6d9188a889ec2225e7a","modified":1655551190327},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_3.webp","hash":"3faffd2575e0751526249c5c56a2a5045a21363b","modified":1655551190440},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_4.webp","hash":"1d0f136590632e7ba31f5510d24891ba443f1f33","modified":1655551190445},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_5.webp","hash":"ba384ada1c2a17b67036addd68ffa1f604ab5a41","modified":1655551190452},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_6.webp","hash":"c2d8b68971dacd111566526f64d94932f5c6f076","modified":1655551190461},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_7.webp","hash":"4be8fe8ea1b3563b78924062e3aa013cd5c4e82b","modified":1655551190464},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_8.webp","hash":"9e6d74786d8459440d68c409eb654364dd279f8a","modified":1655551190470},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/thumb/thumb_9.webp","hash":"bca69e7d56982b43c52e9ffa17c8d5bb268834d8","modified":1655551190472},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_tools/share.ejs","hash":"3f7369fc6344965f12315e5214aa9eee3fe8b5f1","modified":1655551189852},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/_widget/toc.ejs","hash":"09bbd53a479953600de7f1f2e68e3c72c43410c5","modified":1655551189860},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/avatar.webp.bak","hash":"3ed6e4e1e08e9c2700aa149d1f9e068fb02947cd","modified":1655551189942},{"_id":"source/_posts/nixos-guide-cn.md","hash":"452e12827ea458cf5c89f52943ad866cea951d5d","modified":1655605047038},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/nixos.svg","hash":"efff3ad449415a42beb0c029dce7d28b8d82ae66","modified":1655604830402},{"_id":"node_modules/hexo-theme-kratos-rebirth/layout/about.ejs","hash":"7b7984996c98ceef3fb7708ad594ac097d335500","modified":1655605507140},{"_id":"node_modules/hexo-theme-kratos-rebirth/source/images/rin.jpg","hash":"7394a08c56ba6a9294641b5a88b18e67702d3fbd","modified":1655629140598}],"Category":[{"name":"教程","_id":"cl4k28bsm0001trgq9jch4afe"}],"Data":[],"Page":[],"Post":[{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"date":"2022-06-18T07:39:47.848Z","updated":"2022-06-18T07:39:47.848Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jn6ei80000gcgq0xim4y0g","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"一个配置文件就能在各个电脑装一模一样的系统和软件？——保姆级教你轻松掌握NixOS","author":["Lanta","一穂灯花","Chi_Tang","NixOS Chinese Community"],"date":"2022-05-06T01:15:59.000Z","_content":"\n<h1 align=\"center\">\n  <img src=\"https://pic.lanta.cyou/img/nix-snowflake.svg\" width=\"200\">\n  <br>NixOS<br>\n</h1>\n\n<div class=\"info\">\n\n\n>非常感谢[一穂灯花](https://github.com/YisuiDenghua)在我安装NixOS中提供的帮助，以完成我对NixOS的学习和本文章的创作\n\n</div>\n\n\n# NixOS 适合我吗？\n\n>「如果你不需要 Ubuntu 那种的开箱即用的，觉得 Arch 那样的自己动手可以接受，喜欢 Gentoo 的可配置性，又不想自己完全编译整个世界，并且觉得所有系统配置全都由统一格式写出来的可复现性确实很棒，并且觉得那帮人为了 portable 和轻量级，自己做了个 Nix 语言可以接受的话，NixOS 可能就是专门为你设计的。」—— [Dramforever](https://github.com/dramforever)，NixOS 中文社区管理员之一\n\n# 前排提示\n\n由于 NixOS 系统的配置，操作方式和传统的 Linux 发行版有很大不同，建议新手在先在虚拟机中试用 NixOS，等到熟悉了之后，将 configuration.nix 等配置文件导出，而后能够在宿主机上使用相同的配置复现出一个一样的 NixOS。\n\n在安装的时候，建议新人阅读 NixOS 自带的手册 NixOS Manual，以及在 [search.nixos.org](search.nixos.org) 上查询软件包名（Packages）和配置语句（Options）\n\n\n\n>永远不要想着用常规 Linux 方式在 NixOS 上安装软件。因为 NixOS 不遵守 fhs，也就是说，它的根目录结构和常规的 Linux 是不一样的。不信你看看，NixOS 的 /bin 下什么都没有。—— [一穂灯花](https://github.com/YisuiDenghua)\n\n# 认识NixOS\n\nNixOS 是一个基于 Nix 包管理器和 Nix 构建系统的 Linux 发行版。它支持可重现和声明性的系统配置管理以及事务回滚，它也支持命令式的软件包和用户管理。在 NixOS 中，发行版的所有组件——包括内核，安装的包和系统配置文件都是由 Nix 表达式构建的。\n\n## 软件包的安装方式\n\nNixOS 非常不同，如果你想安装软件，有多种安装方式，这里举三个例子\n\n1. 声明式的软件包管理（编辑 NixOS 的配置文件`/etc/nixos/configuration.nix`）\n\n<div class=\"info\">\n\n\n>安装在`configuration.nix`的软件就是构建在系统里面了，而且因为在配置文件里面，下次你要安装NixOS到其他电脑，只要用这个配置文件（可能需要稍微修改一下）就可以轻松安装NixOS顺便安装你需要的软件了\n>\n>比如说我需要装git，把 git 写进`configuration.nix`\n>\n> ```nix\n> environment.systemPackages = with pkgs; [ \n> git\n> ];  \n> ```\n>\n>然后 `nixos-rebuild boot`重启就可以安装完成\n>\n>缺点是，需要重启（因为重构了部分系统文件），不过重构的时间并不多，基本上几分钟就可以了\n\n</div>\n\n<div class=\"warning\">\n\n\n>需要注意的是，有一些软件的开源协议是**不自由**的，所以NixOS会阻止你的安装操作\n>\n>要解决这个问题也很简单，只要在`configuration.nix`中允许即可，在里面加入`nixpkgs.config.allowUnfree = true;`\n>\n>例如：\n>\n>![](https://pic.lanta.cyou/img/2022-05-06_09-45.png)\n\n</div>\n\n2.`nix-shell`临时使用\n\n<div class=\"info\">\n\n\n>`nix-shell`的安装是临时使用，比如我要临时用一下git，那就`nix-shell -p git`\n>\n>随后，你会进入一个 nix-shell，在这个 nix-shell 当中，你可以使用 git。当你用 `exit`退出 nix-shell 之后，git 就不再可用。\n\n</div>\n\n3. 命令式的软件包管理（`nix-env -iA nixos.<包名>`）\n\n<div class=\"warning\">\n\n> 不推荐使用这种方式安装软件\n\n</div>\n\n<div class=\"info\">\n\n\n> 这种不需要 sudo，也不需要重构，它是把软件安装在用户的目录下\n>\n> 缺点是，这种方式安装的软件不能被 configuration.nix 记录，也不能被其他用户使用\n>\n> ——[一穂灯花](https://github.com/YisuiDenghua)\n\n</div>\n\n## NixOS 的配置是可复现的\n\nNixOS跟其他Linux发行版最大的不同就是，NixOS 的配置是可复现的。几乎所有的系统设置都在`configuration.nix`\n\n例如，添加用户、安装的软件、字体、网络、系统引导、桌面环境，全部包含在了这么一个文件里面。而不是像其他发行版那样，配置文件散落在系统各处。\n\n也就是说，只要你在`configuration.nix`配置好之后，下次你需要安装到其他电脑只要再用这个配置文件然后`nixos-install`就可以得到一模一样的NixOS。\n\n同理，如果你去Github下载别人的`configuration.nix`，你可以得到跟他们一模一样的NixOS\n\n\n\n>  笔者的[`configuration.nix`](https://github.com/RealLanta/nixos-config)\n\n# 准备操作\n\n首先你需要确保你的网络畅通，NixOS是**在线安装**。也就是说，安装的过程需要保持网络连接。\n\n## 下载LiveCD\n\n你可以前往[清华大学开源软件镜像站](https://mirrors.tuna.tsinghua.edu.cn/nixos-images/)中下载NixOS的Live CD\n\n![](https://pic.lanta.cyou/img/2022-05-06_09-47.png)\n\n<div class=\"warning\">\n\n\n>请尽量下载较新的版本\n\n</div>\n\n里面有很多个镜像，这里做一下解释\n\n![](https://pic.lanta.cyou/img/2022-05-06_09-50.png)\n\n## 刻录到U盘\n\n你可以使用以下几种方式来将NixOS镜像刻录到U盘中\n\n<div class=\"danger\">\n\n\n\n> 刻录到U盘会导致数据丢失，请在操作之前备份好你的U盘数据\n\n</div>\n\n<div class=\"warning\">\n\n>警告：Ventoy 的硬件支持比较有限。在使用 Ventoy 前，需先阅读其官网的文档，以了解硬件支持情况\n\n</div>\n\n| 名称                                          | 使用方式                                        | 备注               |\n| --------------------------------------------- | ----------------------------------------------- | ------------------ |\n| [Ventoy](https://ventoy.net/)                 | 将Ventoy安装到U盘后直接把ISO文件复制到U盘中即可 | 一次安装，一盘多用 |\n| [Rufus](https://rufus.ie/)                    | 选择ISO文件然后选择U盘直接刻录即可              | 注意选择引导方式   |\n| [balenaEtcher](https://www.balena.io/etcher/) | 选择ISO文件然后选择U盘点击Flash开始刻录         | 最简单的方法       |\n\n## 确定分区（必要）\n\n在纯文字的环境中你可能**很难分辨**分区，如果**操作失误**（删错分区）~~则删库跑路~~\n\n所以我建议你**事先**在Windows环境中**确定**要安装的系统分区，以确保不会出现失误导致的~~数据灰飞烟灭~~\n\n\n## 引导设置（UEFI用户）\n\n进入BIOS中，如果你是有UEFI的电脑那么你应该能看到带有**CSM**字样的选项，将他**Disable**掉\n\n还有一些电脑带有**Secure Boot（安全启动）**，找到**Secure Boot**的字样**Disable**即可\n\n## 重启开始安装\n\n确保您的U盘已经写入了镜像、分区已经确定好没问题之后就可以重启进入LiveCD\n\n# LiveCD\n\n## 进入NixOS的root\n\n进入终端后你会发现NixOS默认登录的不是root账户，首先你需要登录到root账户才能继续\n\n打开终端，输入`sudo -i`即可进入root账户\n\n## 确保网络畅通\n\n前面提到，NixOS是在线安装方式，所以你必须要确保LiveCD中的系统已经连接到了网络\n\n### 有线网络\n\n一般来说如果你使用了带桌面环境的ISO就已经可以自动联网\n\n不过发现网络出现玄学问题，你可以执行`systemctl restart dhcpcd`来重启DHCP服务让Live CD重新获取IP\n\n### WiFi连接\n\n提供了 GUI 的 LiveCD 中自带 NetworkManager，你可以一步一步让Live CD连接到WiFi\n\n```bash\n[root@nixos ~]# nmcli device wifi connect <WIFI名> password <密码>\n```\n\n然而，在最小化的纯命令行安装镜像中，NetworkManager 不是可用的，所以必须手动配置网络。要配置 WiFi，首先使用 `sudo systemctl start wpa_supplicant`，然后运行 `wpa_cli`。对于大多数家庭网络，你需要像这样输入命令：\n\n```shell\n> add_network\n0\n> set_network 0 ssid \"我的网络名称\"\nOK\n> set_network 0 psk \"我的密码\"\nOK\n> set_network 0 key_mgmt WPA-PSK\nOK\n> enable_network 0\nOK\n\n```\n\n对于企业网络，例如 *eduroam*，应该这样做：\n\n```shell\n> add_network\n0\n> set_network 0 ssid \"eduroam\"\nOK\n> set_network 0 identity \"myname@example.com\"\nOK\n> set_network 0 password \"mypassword\"\nOK\n> set_network 0 key_mgmt WPA-EAP\nOK\n> enable_network 0\nOK\n```\n\n一旦成功连接，你会看到这样的提示：\n\n```shell\n<3>CTRL-EVENT-CONNECTED - Connection to 32:85:ab:ef:24:5c completed [id=0 id_str=]\n```\n\n现在，你可以通过输入 `quit`来离开`wpa_cli`。\n\n\n\n> 提示：如果你想要在另一台机器上远程安装，你可以在联网之后，使用`systemctl start sshd` 激活 OpenSSH 守护程序 。另外，你还必须使用 `passwd` 为 root 用户或 nixos （livecd 的默认用户）设置密码。\n\n## 分区\n\n先通过`lsblk`或`fdisk -l`的方式确定硬盘，出现`/dev/某某某`的就是这个硬盘的设备名，记住硬盘的设备名，等会要用到\n\n### 分区的工具\n\nLiveCD中有`parted`、`fdisk`、`cfdisk`等工具，前两个比较麻烦，`cfdisk`拥有半图形界面，更适合新手使用\n\n如果使用带有 GUI 的 livecd，则 `gparted` 也是可用的。这里以 cfdisk 为例：\n\n首先我们要打开cfdisk\n\n<div class=\"info\">\n\n\n\n> 设sdX为你的硬盘号\n\n</div>\n\n```bash\ncfdisk /dev/sdX # 后面这个就是硬盘设备名\n```\n\n然后就会出现一个界面，这里以一个中文化的界面作为对照\n\n![](https://pic.lanta.cyou/img/20220326033131.png)\n\n### 分区格式\n\n<div class=\"info\">\n\n\n\n>  用户资料分区是可选的，可以将用户资料存放在系统盘中\n\n</div>\n\n#### MBR（传统引导）推荐分区格式：\n\n| 用途                 | 文件系统 | 分区推荐大小 | 挂载点 | 文章中的分区号                   |\n| -------------------- | -------- | ------------ | ------ | -------------------------------- |\n| 系统分区             | ext4     | 50GiB        | /      | /dev/sda2                        |\n| 用户资料分区（可选） | ext4     | 50GiB        | /home  | （本文章中没有设置用户资料分区） |\n\n#### GPT（UEFI引导）推荐分区格式：\n\n<div class=\"danger\">\n\n\n\n> 如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区删掉重建，否则会导致原来的系统无法进入！\n\n</div>\n\n<div class=\"danger\">\n\n\n\n> 因为某些机制的原因，请记得在`cfdisk`中把引导分区的“类型”(Type)改为\"EFI System\"\n\n</div>\n\n| 用途                 | 文件系统 | 分区推荐大小 | 挂载点 | 文章中的分区号                   |\n| -------------------- | -------- | ------------ | ------ | -------------------------------- |\n| 引导分区             | FAT32    | 300MiB       | /efi   | /dev/sda1                        |\n| 系统分区             | ext4     | 50GiB        | /      | /dev/sda2                        |\n| 用户资料分区（可选） | ext4     | 50GiB        | /home  | （本文章中没有设置用户资料分区） |\n\n> 提示：如果你选择将 EFI 引导分区挂载到不是 `/boot` 的挂载点，例如 `/efi`，你还需要在接下来编辑 `configuration.nix` 的时候写入\n>\n> ```\n> boot.loader.efi.efiSysMountPoint = \"/efi\";\n> \n> ```\n>\n> 其中，`/efi`可以替换为你所使用的挂载点\n\n## 格式化分区\n\n<div class=\"danger\">\n\n\n\n> 如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区格式化，否则会导致原来的系统无法进入！\n\n</div>\n\n<div class=\"info\">\n\n\n\n> 设引导分区为 /dev/sda1，系统分区为 /dev/sda2\n\n</div>\n\n```bash\nmkfs.ext4 /dev/sda2 # 格式化 /dev/sda2 为 ext4 文件系统（系统分区或用户资料分区）\nmkfs.vfat /dev/sda1 # 格式化 /dev/sda1 为 FAT32 文件系统（引导分区）\n```\n\n## 挂载分区\n\n### GPT\n\n<div class=\"info\">\n\n\n\n> 设引导分区为 /dev/sda1，系统分区为 /dev/sda2，用户资料分区为/dev/sda3\n\n</div>\n\n```bash\nmount /dev/sda2 /mnt # 挂载系统分区到 /mnt( / 分区)\nmkdir /mnt/boot /mnt/home # 新建 /mnt/boot 文件夹和 /mnt/home 文件夹\nmount /dev/sda1 /mnt/boot # 挂载引导分区到 /mnt/boot\nmount /dev/sda3 /mnt/home # 挂载用户资料分区到 /mnt/home （ /home 分区，在有用户资料分区的情况下才执行）\n```\n\n### MBR\n\n```bash\nmount /dev/sda1 /mnt  # 挂载系统分区到 /mnt( / 分区)\nmkdir /mnt/home # 创建 /mnt/home 文件夹\nmount /dev/sda2 /mnt/home # 挂载用户资料分区到 /mnt/home( /home 分区，在有用户资料分区的情况下才执行)\n```\n\n（以上文段参考了[Chi_Tang的博客](https://chitang.tech/posts/arch-guide/#%E6%8C%82%E8%BD%BD)并进行修改）\n\n## 安装本体到硬盘\n\n### 使用中国的 nix-channel\n\n```shell\nnix-channel --add https://mirrors.ustc.edu.cn/nix-channels/nixos-unstable nixos\nnix-channel --update\n```\n\n### 生成配置文件\n\n```bash\n # nixos-generate-config --root /mnt\n```\n\n该命令会生成配置文件到`/mnt/etc/nixos/`目录中，里面包括了硬件配置文件(`hardware-configuration.nix`)和`configuration.nix`\n\n如果你有自己配置好的`configuration.nix`只要替换掉即可\n\n> 提示：在修改 NixOS 配置文件的时候要注意缩进及分号 `;` 的使用。`configuration.nix` 当中已经存在一些默认配置好的语句，可以参考它们的格式。\n\n### 更改配置文件\n\n> 「古人云：『知其然，知其所以然。（宋・朱熹《建宁府建阳县长滩社仓记》）』意思是说，在知道事物的表面现象的同时，更应去探明事物的本质及其产生的原因。同样的道理可以应用在 Nix 上。在配置 NixOS 的时候，总抄作业可不是好习惯。抄袭其他人的配置文件能够满足用户一时的使用，但此时的用户仍然没有了解 Nix 的设置方法，当用户真正有自己需求的时候，仍然不知该怎么做。相比起抄袭其他人配置文件，我更希望用户阅读 NixOS 自带的手册 NixOS Manual，以及在 [search.nixos.org](search.nixos.org) 上查询软件包名（Packages）和配置语句（Options）。这样，用户能真正学到 NixOS 独特的声明式配置方式的精髓。」 ——[一穗灯花](github.con/YisuiDenghua)\n\n\n\n使用vim开始编辑\n\n```bash\nvim /mnt/etc/nixos/configuration.nix\n```\n\n#### 允许安装不自由的软件\n\n```nix\n  nixpkgs.config.allowUnfree = true;\n```\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-15.png)\n\n#### 安装NotoFonts字体以显示中文和其他特殊字符\n\n```nix\n  fonts.fonts = with pkgs; [\n    noto-fonts\n    noto-fonts-cjk\n    noto-fonts-emoji\n    meslo-lgs-nf\n  ];\n```\n\n\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-16.png)\n\n#### 设置时区\n\n```nix\n  time.timeZone = \"Asia/Shanghai\";\n```\n\n\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-16_1.png)\n\n#### 使用NetworkManager联网\n\n```nix\n  networking.networkmanager.enable = true;\n```\n\n\n\n![](https://pic.lanta.cyou/img/20220506104638.png)\n\n#### 设置中文\n\n```nix\n  i18n.defaultLocale = \"zh_CN.UTF-8\";\n  i18n.inputMethod.enabled = \"fcitx5\";\n  i18n.inputMethod.fcitx5.addons = with pkgs; [ fcitx5-rime ];\n\n```\n\n> 提示：这里使用 `fcitx5-rime `作为示例。用户可以将其替换为 `fcitx5-chinese-addons` 等其他输入法。\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-19.png)\n\n#### 设置桌面环境\n\n如果你使用的是Plasma，那么生成配置文件的时候会自动帮你设置好Plasma，Gnome用户同理。这里以 KDE Plasma 和 GNU GNOME 为例：\n\n<div class=\"warning\">\n\n> 警告：在 NixOS 上，无法同时启用 GNOME 和 KDE Plasma。\n\n</div>\n\n```nix\n  # 如果要使用 GNOME：\n  services.xserver.enable = true;\n  services.xserver.displayManager.gdm.enable = true;\n  services.xserver.desktopManager.gnome.enable = true;\n```\n\n```nix\n  # 如果要使用 KDE Plasma\n  services.xserver.enable = true;\n  services.xserver.displayManager.sddm.enable = true;\n  services.xserver.desktopManager.plasma5.enable = true;\n\n```\n\n> 提示：如果想要启用 Plasma 的 Qt 缩放，你还需要添加一条语句：\n>\n> ```   services.xserver.desktopManager.plasma5.useQtScaling = **true**;\n> services.xserver.desktopManager.plasma5.useQtScaling = true;\n> ```\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-20.png)\n\n#### 设置普通用户\n\n```nix\n  users.users.<用户名> = {\n    isNormalUser = true;\n    shell = pkgs.zsh;\n    extraGroups = [ \"wheel\" ]; # Enable ‘sudo’ for the user.\n  };\n\n```\n\n> 提示，如果你的用户要使用图形界面，你还需要将 `\"video\"` 加入到  `extraGroups = [  ];  ` 当中；如果你的用户要使用 `docker`，你还需要将`\"docker\"`加入语句中。如果你不想给用户使用 `sudo` 的权利，将  `\"wheel\" ` 从上述语句中移除。\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-22.png)\n\n#### 设置安装的软件\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-25.png)\n\n#### 开启SSH（可选）\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-26.png)\n\n\n\n### 提示：用户的特殊需求\n\n对于某些有特殊需求的用户，需要在安装之前按需修改配置文件。\n\n#### 使用 NUR\n\n```\n  nixpkgs.config.packageOverrides = pkgs: {\n    nur = import (builtins.fetchTarball \"https://github.com/nix-community/NUR/archive/master.tar.gz\") {\n      inherit pkgs;\n    };\n  };  \n    \n```\n\n而后，可以在 https://nur.nix-community.org/ 上搜索 NUR 软件包，例如微信。然后，可以使用声明式的方式安装：\n\n![](https://pic.lanta.cyou/img/photo_2022-05-06_13-49-27.jpg)\n\n```nix\n  environment.systemPackages = with pkgs; [\n    nur.repos.xddxdd.wechat-uos-bin\n   ];\n```\n\n> 提示：由于 NUR 使用 [GitHub](github.com) 来托管软件包代码，而 GitHub 在国内的某些地区连接不佳，你可能还需要在安装之前配置代理。\n>\n> 可以通过 `nix-env -iA nixos.v2ray` 在安装 LiveCD 里临时安装 `v2ray`。对于带有 GUI 的 LiveCD，可使用 `nix-env -iA nixos.qv2ray`。在使用 `qv2ray` 的时候，需参照 https://qv2ray.net/lang/zh/getting-started/step2.html 配置其核心文件。\n\n#### 使用 AMD 显卡\n\n```\nhardware.opengl.extraPackages = [\n  rocm-opencl-icd\n  pkgs.amdvlk\n];\n```\n\n#### 使用 Intel Gen8 或更新的显卡\n\n```\nhardware.opengl.extraPackages = [\n  intel-compute-runtime\n];\n```\n\n#### 使用 NVIDIA 显卡\n\n<div class=\"warning\">\n\n> 警告：如果你正在为 Linux 选购硬件，除非特殊需要，请避免使用由 NVIDIA，Realtek，Broadcom 以及 Apple Inc 生产的设备。在这些公司所生产的硬件设备上部署 Linux 可能会非常棘手。\n\n</div>\n\n```nix\n  services.xserver.videoDrivers = [ \"nvidia\" ];\n```\n\n<div class=\"info\">\n\n> 提示：由于 NVIDIA 的驱动是非自由软件，你同时还需要在配置文件中使用 `  nixpkgs.config.allowUnfree = true;`启用非自由软件\n\n</div>\n\n#### 使用数位板\n\n```nix\n  services.xserver.wacom.enable = true;\n  services.xserver.digimend.enable = true;\n  hardware.opentabletdriver.enable = true;\n  hardware.opentabletdriver.daemon.enable = true;\n```\n\n#### 使用 Steam\n\n```\n  programs.steam.enable = true;\n```\n\n#### 使用 AppImage\n\n安装软件包 `appimage-run`\n\n#### 使用为常规 Linux 而编译的二进行程序\n\n安装软件包 `steam-run`\n\n#### 在 NixOS 中作为宿主时使用 VirtualBox\n\n```nix\n  virtualisation.virtualbox.host.enable = true;\n  users.extraGroups.vboxusers.members = [ \"<用户名>\" ];\n```\n\n#### 在 NixOS 中作为宿主时使用 KVM\n\n```nix\n  virtualisation.libvirtd.qemu.package = pkgs.qemu_kvm;\n  virtualisation.libvirtd.enable = true;\n```\n\n#### 使用 Flatpak\n\n<div class=\"warning\">\n\n>如果你这 Flatpak 安装了有中文的软件，请在 `~/.local/share/fonts/` 目录里放几个中文字体，否则中文无法正常显示\n\n</div>\n\n```nix\n  services.flatpak.enable = true;\n```\n\n> 提示：如果你使用非 GNOME 的桌面环境，你还需要配置\n>\n> ```nix\n> xdg.portal.extraPortals = [ pkgs.xdg-desktop-portal-gtk ];\n> ```\n\n在启用 flatpak 之后，需要导入 flathub 源：\n\n```shell\nflatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo\nflatpak update\n```\n#### 开启支持 NTFS 读写\n\n<div class=\"warning\">\n\n> 如果你有使用 NTFS 格式的硬盘，在 `configuration.nix` 中加入以下字段来提供 NTFS 的支持\n\n```nix\nboot.supportedFilesystems = [ \"ntfs\" ];\n```\n\n</div>\n\n#### 使用 Docker\n\n```nix\n  virtualisation.docker.enable = true;\n```\n\n此外，你还需要将用户加入 \"docker\" 用户组\n\n#### 使用其他 Linux 内核\n\n`Packages` 选项来指定 NixOS 使用的内核。例如：使用 `linux-zen`\n\n```nix\n  boot.kernelPackages = pkgs.linuxPackages_zen;\n```\n\n#### 使用中国的 Nix 二进制源\n\n```nix\n  nix.settings.substituters = [ \"https://mirrors.ustc.edu.cn/nix-channels/store\" ];\n```\n<div class=\"warning\">\n\n> 注意\n>\n> 在NixOS 21.11中，不存在 `nix.settings` 段\n>\n> 所以如果你安装的是NixOS 21.11，要改成下面这样：\n>\n> `nix.binaryCaches = [ \"https://mirrors.ustc.edu.cn/nix-channels/store\" ];`\n\n</div>\n\n### 安装 NixOS\n\n```bash\nnixos-install --root /mnt\n```\n\n## 重启\n\n<div class=\"success\">\n\n> 到这里，我们的LiveCD的安装步骤就完成了，曙光就在眼前了！接下来我们重启就可以进入你配置好的NixOS\n\n</div>\n\n","source":"_posts/nixos-guide-cn.md","raw":"---\ntitle: 一个配置文件就能在各个电脑装一模一样的系统和软件？——保姆级教你轻松掌握NixOS\nauthor: \n - Lanta\n - 一穂灯花\n - Chi_Tang\n - NixOS Chinese Community\ndate: 2022-05-06 09:15:59\ntags: \n - NixOS\n - Linux\n - 保姆级教程\ncategories: 教程\n\n---\n\n<h1 align=\"center\">\n  <img src=\"https://pic.lanta.cyou/img/nix-snowflake.svg\" width=\"200\">\n  <br>NixOS<br>\n</h1>\n\n<div class=\"info\">\n\n\n>非常感谢[一穂灯花](https://github.com/YisuiDenghua)在我安装NixOS中提供的帮助，以完成我对NixOS的学习和本文章的创作\n\n</div>\n\n\n# NixOS 适合我吗？\n\n>「如果你不需要 Ubuntu 那种的开箱即用的，觉得 Arch 那样的自己动手可以接受，喜欢 Gentoo 的可配置性，又不想自己完全编译整个世界，并且觉得所有系统配置全都由统一格式写出来的可复现性确实很棒，并且觉得那帮人为了 portable 和轻量级，自己做了个 Nix 语言可以接受的话，NixOS 可能就是专门为你设计的。」—— [Dramforever](https://github.com/dramforever)，NixOS 中文社区管理员之一\n\n# 前排提示\n\n由于 NixOS 系统的配置，操作方式和传统的 Linux 发行版有很大不同，建议新手在先在虚拟机中试用 NixOS，等到熟悉了之后，将 configuration.nix 等配置文件导出，而后能够在宿主机上使用相同的配置复现出一个一样的 NixOS。\n\n在安装的时候，建议新人阅读 NixOS 自带的手册 NixOS Manual，以及在 [search.nixos.org](search.nixos.org) 上查询软件包名（Packages）和配置语句（Options）\n\n\n\n>永远不要想着用常规 Linux 方式在 NixOS 上安装软件。因为 NixOS 不遵守 fhs，也就是说，它的根目录结构和常规的 Linux 是不一样的。不信你看看，NixOS 的 /bin 下什么都没有。—— [一穂灯花](https://github.com/YisuiDenghua)\n\n# 认识NixOS\n\nNixOS 是一个基于 Nix 包管理器和 Nix 构建系统的 Linux 发行版。它支持可重现和声明性的系统配置管理以及事务回滚，它也支持命令式的软件包和用户管理。在 NixOS 中，发行版的所有组件——包括内核，安装的包和系统配置文件都是由 Nix 表达式构建的。\n\n## 软件包的安装方式\n\nNixOS 非常不同，如果你想安装软件，有多种安装方式，这里举三个例子\n\n1. 声明式的软件包管理（编辑 NixOS 的配置文件`/etc/nixos/configuration.nix`）\n\n<div class=\"info\">\n\n\n>安装在`configuration.nix`的软件就是构建在系统里面了，而且因为在配置文件里面，下次你要安装NixOS到其他电脑，只要用这个配置文件（可能需要稍微修改一下）就可以轻松安装NixOS顺便安装你需要的软件了\n>\n>比如说我需要装git，把 git 写进`configuration.nix`\n>\n> ```nix\n> environment.systemPackages = with pkgs; [ \n> git\n> ];  \n> ```\n>\n>然后 `nixos-rebuild boot`重启就可以安装完成\n>\n>缺点是，需要重启（因为重构了部分系统文件），不过重构的时间并不多，基本上几分钟就可以了\n\n</div>\n\n<div class=\"warning\">\n\n\n>需要注意的是，有一些软件的开源协议是**不自由**的，所以NixOS会阻止你的安装操作\n>\n>要解决这个问题也很简单，只要在`configuration.nix`中允许即可，在里面加入`nixpkgs.config.allowUnfree = true;`\n>\n>例如：\n>\n>![](https://pic.lanta.cyou/img/2022-05-06_09-45.png)\n\n</div>\n\n2.`nix-shell`临时使用\n\n<div class=\"info\">\n\n\n>`nix-shell`的安装是临时使用，比如我要临时用一下git，那就`nix-shell -p git`\n>\n>随后，你会进入一个 nix-shell，在这个 nix-shell 当中，你可以使用 git。当你用 `exit`退出 nix-shell 之后，git 就不再可用。\n\n</div>\n\n3. 命令式的软件包管理（`nix-env -iA nixos.<包名>`）\n\n<div class=\"warning\">\n\n> 不推荐使用这种方式安装软件\n\n</div>\n\n<div class=\"info\">\n\n\n> 这种不需要 sudo，也不需要重构，它是把软件安装在用户的目录下\n>\n> 缺点是，这种方式安装的软件不能被 configuration.nix 记录，也不能被其他用户使用\n>\n> ——[一穂灯花](https://github.com/YisuiDenghua)\n\n</div>\n\n## NixOS 的配置是可复现的\n\nNixOS跟其他Linux发行版最大的不同就是，NixOS 的配置是可复现的。几乎所有的系统设置都在`configuration.nix`\n\n例如，添加用户、安装的软件、字体、网络、系统引导、桌面环境，全部包含在了这么一个文件里面。而不是像其他发行版那样，配置文件散落在系统各处。\n\n也就是说，只要你在`configuration.nix`配置好之后，下次你需要安装到其他电脑只要再用这个配置文件然后`nixos-install`就可以得到一模一样的NixOS。\n\n同理，如果你去Github下载别人的`configuration.nix`，你可以得到跟他们一模一样的NixOS\n\n\n\n>  笔者的[`configuration.nix`](https://github.com/RealLanta/nixos-config)\n\n# 准备操作\n\n首先你需要确保你的网络畅通，NixOS是**在线安装**。也就是说，安装的过程需要保持网络连接。\n\n## 下载LiveCD\n\n你可以前往[清华大学开源软件镜像站](https://mirrors.tuna.tsinghua.edu.cn/nixos-images/)中下载NixOS的Live CD\n\n![](https://pic.lanta.cyou/img/2022-05-06_09-47.png)\n\n<div class=\"warning\">\n\n\n>请尽量下载较新的版本\n\n</div>\n\n里面有很多个镜像，这里做一下解释\n\n![](https://pic.lanta.cyou/img/2022-05-06_09-50.png)\n\n## 刻录到U盘\n\n你可以使用以下几种方式来将NixOS镜像刻录到U盘中\n\n<div class=\"danger\">\n\n\n\n> 刻录到U盘会导致数据丢失，请在操作之前备份好你的U盘数据\n\n</div>\n\n<div class=\"warning\">\n\n>警告：Ventoy 的硬件支持比较有限。在使用 Ventoy 前，需先阅读其官网的文档，以了解硬件支持情况\n\n</div>\n\n| 名称                                          | 使用方式                                        | 备注               |\n| --------------------------------------------- | ----------------------------------------------- | ------------------ |\n| [Ventoy](https://ventoy.net/)                 | 将Ventoy安装到U盘后直接把ISO文件复制到U盘中即可 | 一次安装，一盘多用 |\n| [Rufus](https://rufus.ie/)                    | 选择ISO文件然后选择U盘直接刻录即可              | 注意选择引导方式   |\n| [balenaEtcher](https://www.balena.io/etcher/) | 选择ISO文件然后选择U盘点击Flash开始刻录         | 最简单的方法       |\n\n## 确定分区（必要）\n\n在纯文字的环境中你可能**很难分辨**分区，如果**操作失误**（删错分区）~~则删库跑路~~\n\n所以我建议你**事先**在Windows环境中**确定**要安装的系统分区，以确保不会出现失误导致的~~数据灰飞烟灭~~\n\n\n## 引导设置（UEFI用户）\n\n进入BIOS中，如果你是有UEFI的电脑那么你应该能看到带有**CSM**字样的选项，将他**Disable**掉\n\n还有一些电脑带有**Secure Boot（安全启动）**，找到**Secure Boot**的字样**Disable**即可\n\n## 重启开始安装\n\n确保您的U盘已经写入了镜像、分区已经确定好没问题之后就可以重启进入LiveCD\n\n# LiveCD\n\n## 进入NixOS的root\n\n进入终端后你会发现NixOS默认登录的不是root账户，首先你需要登录到root账户才能继续\n\n打开终端，输入`sudo -i`即可进入root账户\n\n## 确保网络畅通\n\n前面提到，NixOS是在线安装方式，所以你必须要确保LiveCD中的系统已经连接到了网络\n\n### 有线网络\n\n一般来说如果你使用了带桌面环境的ISO就已经可以自动联网\n\n不过发现网络出现玄学问题，你可以执行`systemctl restart dhcpcd`来重启DHCP服务让Live CD重新获取IP\n\n### WiFi连接\n\n提供了 GUI 的 LiveCD 中自带 NetworkManager，你可以一步一步让Live CD连接到WiFi\n\n```bash\n[root@nixos ~]# nmcli device wifi connect <WIFI名> password <密码>\n```\n\n然而，在最小化的纯命令行安装镜像中，NetworkManager 不是可用的，所以必须手动配置网络。要配置 WiFi，首先使用 `sudo systemctl start wpa_supplicant`，然后运行 `wpa_cli`。对于大多数家庭网络，你需要像这样输入命令：\n\n```shell\n> add_network\n0\n> set_network 0 ssid \"我的网络名称\"\nOK\n> set_network 0 psk \"我的密码\"\nOK\n> set_network 0 key_mgmt WPA-PSK\nOK\n> enable_network 0\nOK\n\n```\n\n对于企业网络，例如 *eduroam*，应该这样做：\n\n```shell\n> add_network\n0\n> set_network 0 ssid \"eduroam\"\nOK\n> set_network 0 identity \"myname@example.com\"\nOK\n> set_network 0 password \"mypassword\"\nOK\n> set_network 0 key_mgmt WPA-EAP\nOK\n> enable_network 0\nOK\n```\n\n一旦成功连接，你会看到这样的提示：\n\n```shell\n<3>CTRL-EVENT-CONNECTED - Connection to 32:85:ab:ef:24:5c completed [id=0 id_str=]\n```\n\n现在，你可以通过输入 `quit`来离开`wpa_cli`。\n\n\n\n> 提示：如果你想要在另一台机器上远程安装，你可以在联网之后，使用`systemctl start sshd` 激活 OpenSSH 守护程序 。另外，你还必须使用 `passwd` 为 root 用户或 nixos （livecd 的默认用户）设置密码。\n\n## 分区\n\n先通过`lsblk`或`fdisk -l`的方式确定硬盘，出现`/dev/某某某`的就是这个硬盘的设备名，记住硬盘的设备名，等会要用到\n\n### 分区的工具\n\nLiveCD中有`parted`、`fdisk`、`cfdisk`等工具，前两个比较麻烦，`cfdisk`拥有半图形界面，更适合新手使用\n\n如果使用带有 GUI 的 livecd，则 `gparted` 也是可用的。这里以 cfdisk 为例：\n\n首先我们要打开cfdisk\n\n<div class=\"info\">\n\n\n\n> 设sdX为你的硬盘号\n\n</div>\n\n```bash\ncfdisk /dev/sdX # 后面这个就是硬盘设备名\n```\n\n然后就会出现一个界面，这里以一个中文化的界面作为对照\n\n![](https://pic.lanta.cyou/img/20220326033131.png)\n\n### 分区格式\n\n<div class=\"info\">\n\n\n\n>  用户资料分区是可选的，可以将用户资料存放在系统盘中\n\n</div>\n\n#### MBR（传统引导）推荐分区格式：\n\n| 用途                 | 文件系统 | 分区推荐大小 | 挂载点 | 文章中的分区号                   |\n| -------------------- | -------- | ------------ | ------ | -------------------------------- |\n| 系统分区             | ext4     | 50GiB        | /      | /dev/sda2                        |\n| 用户资料分区（可选） | ext4     | 50GiB        | /home  | （本文章中没有设置用户资料分区） |\n\n#### GPT（UEFI引导）推荐分区格式：\n\n<div class=\"danger\">\n\n\n\n> 如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区删掉重建，否则会导致原来的系统无法进入！\n\n</div>\n\n<div class=\"danger\">\n\n\n\n> 因为某些机制的原因，请记得在`cfdisk`中把引导分区的“类型”(Type)改为\"EFI System\"\n\n</div>\n\n| 用途                 | 文件系统 | 分区推荐大小 | 挂载点 | 文章中的分区号                   |\n| -------------------- | -------- | ------------ | ------ | -------------------------------- |\n| 引导分区             | FAT32    | 300MiB       | /efi   | /dev/sda1                        |\n| 系统分区             | ext4     | 50GiB        | /      | /dev/sda2                        |\n| 用户资料分区（可选） | ext4     | 50GiB        | /home  | （本文章中没有设置用户资料分区） |\n\n> 提示：如果你选择将 EFI 引导分区挂载到不是 `/boot` 的挂载点，例如 `/efi`，你还需要在接下来编辑 `configuration.nix` 的时候写入\n>\n> ```\n> boot.loader.efi.efiSysMountPoint = \"/efi\";\n> \n> ```\n>\n> 其中，`/efi`可以替换为你所使用的挂载点\n\n## 格式化分区\n\n<div class=\"danger\">\n\n\n\n> 如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区格式化，否则会导致原来的系统无法进入！\n\n</div>\n\n<div class=\"info\">\n\n\n\n> 设引导分区为 /dev/sda1，系统分区为 /dev/sda2\n\n</div>\n\n```bash\nmkfs.ext4 /dev/sda2 # 格式化 /dev/sda2 为 ext4 文件系统（系统分区或用户资料分区）\nmkfs.vfat /dev/sda1 # 格式化 /dev/sda1 为 FAT32 文件系统（引导分区）\n```\n\n## 挂载分区\n\n### GPT\n\n<div class=\"info\">\n\n\n\n> 设引导分区为 /dev/sda1，系统分区为 /dev/sda2，用户资料分区为/dev/sda3\n\n</div>\n\n```bash\nmount /dev/sda2 /mnt # 挂载系统分区到 /mnt( / 分区)\nmkdir /mnt/boot /mnt/home # 新建 /mnt/boot 文件夹和 /mnt/home 文件夹\nmount /dev/sda1 /mnt/boot # 挂载引导分区到 /mnt/boot\nmount /dev/sda3 /mnt/home # 挂载用户资料分区到 /mnt/home （ /home 分区，在有用户资料分区的情况下才执行）\n```\n\n### MBR\n\n```bash\nmount /dev/sda1 /mnt  # 挂载系统分区到 /mnt( / 分区)\nmkdir /mnt/home # 创建 /mnt/home 文件夹\nmount /dev/sda2 /mnt/home # 挂载用户资料分区到 /mnt/home( /home 分区，在有用户资料分区的情况下才执行)\n```\n\n（以上文段参考了[Chi_Tang的博客](https://chitang.tech/posts/arch-guide/#%E6%8C%82%E8%BD%BD)并进行修改）\n\n## 安装本体到硬盘\n\n### 使用中国的 nix-channel\n\n```shell\nnix-channel --add https://mirrors.ustc.edu.cn/nix-channels/nixos-unstable nixos\nnix-channel --update\n```\n\n### 生成配置文件\n\n```bash\n # nixos-generate-config --root /mnt\n```\n\n该命令会生成配置文件到`/mnt/etc/nixos/`目录中，里面包括了硬件配置文件(`hardware-configuration.nix`)和`configuration.nix`\n\n如果你有自己配置好的`configuration.nix`只要替换掉即可\n\n> 提示：在修改 NixOS 配置文件的时候要注意缩进及分号 `;` 的使用。`configuration.nix` 当中已经存在一些默认配置好的语句，可以参考它们的格式。\n\n### 更改配置文件\n\n> 「古人云：『知其然，知其所以然。（宋・朱熹《建宁府建阳县长滩社仓记》）』意思是说，在知道事物的表面现象的同时，更应去探明事物的本质及其产生的原因。同样的道理可以应用在 Nix 上。在配置 NixOS 的时候，总抄作业可不是好习惯。抄袭其他人的配置文件能够满足用户一时的使用，但此时的用户仍然没有了解 Nix 的设置方法，当用户真正有自己需求的时候，仍然不知该怎么做。相比起抄袭其他人配置文件，我更希望用户阅读 NixOS 自带的手册 NixOS Manual，以及在 [search.nixos.org](search.nixos.org) 上查询软件包名（Packages）和配置语句（Options）。这样，用户能真正学到 NixOS 独特的声明式配置方式的精髓。」 ——[一穗灯花](github.con/YisuiDenghua)\n\n\n\n使用vim开始编辑\n\n```bash\nvim /mnt/etc/nixos/configuration.nix\n```\n\n#### 允许安装不自由的软件\n\n```nix\n  nixpkgs.config.allowUnfree = true;\n```\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-15.png)\n\n#### 安装NotoFonts字体以显示中文和其他特殊字符\n\n```nix\n  fonts.fonts = with pkgs; [\n    noto-fonts\n    noto-fonts-cjk\n    noto-fonts-emoji\n    meslo-lgs-nf\n  ];\n```\n\n\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-16.png)\n\n#### 设置时区\n\n```nix\n  time.timeZone = \"Asia/Shanghai\";\n```\n\n\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-16_1.png)\n\n#### 使用NetworkManager联网\n\n```nix\n  networking.networkmanager.enable = true;\n```\n\n\n\n![](https://pic.lanta.cyou/img/20220506104638.png)\n\n#### 设置中文\n\n```nix\n  i18n.defaultLocale = \"zh_CN.UTF-8\";\n  i18n.inputMethod.enabled = \"fcitx5\";\n  i18n.inputMethod.fcitx5.addons = with pkgs; [ fcitx5-rime ];\n\n```\n\n> 提示：这里使用 `fcitx5-rime `作为示例。用户可以将其替换为 `fcitx5-chinese-addons` 等其他输入法。\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-19.png)\n\n#### 设置桌面环境\n\n如果你使用的是Plasma，那么生成配置文件的时候会自动帮你设置好Plasma，Gnome用户同理。这里以 KDE Plasma 和 GNU GNOME 为例：\n\n<div class=\"warning\">\n\n> 警告：在 NixOS 上，无法同时启用 GNOME 和 KDE Plasma。\n\n</div>\n\n```nix\n  # 如果要使用 GNOME：\n  services.xserver.enable = true;\n  services.xserver.displayManager.gdm.enable = true;\n  services.xserver.desktopManager.gnome.enable = true;\n```\n\n```nix\n  # 如果要使用 KDE Plasma\n  services.xserver.enable = true;\n  services.xserver.displayManager.sddm.enable = true;\n  services.xserver.desktopManager.plasma5.enable = true;\n\n```\n\n> 提示：如果想要启用 Plasma 的 Qt 缩放，你还需要添加一条语句：\n>\n> ```   services.xserver.desktopManager.plasma5.useQtScaling = **true**;\n> services.xserver.desktopManager.plasma5.useQtScaling = true;\n> ```\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-20.png)\n\n#### 设置普通用户\n\n```nix\n  users.users.<用户名> = {\n    isNormalUser = true;\n    shell = pkgs.zsh;\n    extraGroups = [ \"wheel\" ]; # Enable ‘sudo’ for the user.\n  };\n\n```\n\n> 提示，如果你的用户要使用图形界面，你还需要将 `\"video\"` 加入到  `extraGroups = [  ];  ` 当中；如果你的用户要使用 `docker`，你还需要将`\"docker\"`加入语句中。如果你不想给用户使用 `sudo` 的权利，将  `\"wheel\" ` 从上述语句中移除。\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-22.png)\n\n#### 设置安装的软件\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-25.png)\n\n#### 开启SSH（可选）\n\n![](https://pic.lanta.cyou/img/2022-05-06_10-26.png)\n\n\n\n### 提示：用户的特殊需求\n\n对于某些有特殊需求的用户，需要在安装之前按需修改配置文件。\n\n#### 使用 NUR\n\n```\n  nixpkgs.config.packageOverrides = pkgs: {\n    nur = import (builtins.fetchTarball \"https://github.com/nix-community/NUR/archive/master.tar.gz\") {\n      inherit pkgs;\n    };\n  };  \n    \n```\n\n而后，可以在 https://nur.nix-community.org/ 上搜索 NUR 软件包，例如微信。然后，可以使用声明式的方式安装：\n\n![](https://pic.lanta.cyou/img/photo_2022-05-06_13-49-27.jpg)\n\n```nix\n  environment.systemPackages = with pkgs; [\n    nur.repos.xddxdd.wechat-uos-bin\n   ];\n```\n\n> 提示：由于 NUR 使用 [GitHub](github.com) 来托管软件包代码，而 GitHub 在国内的某些地区连接不佳，你可能还需要在安装之前配置代理。\n>\n> 可以通过 `nix-env -iA nixos.v2ray` 在安装 LiveCD 里临时安装 `v2ray`。对于带有 GUI 的 LiveCD，可使用 `nix-env -iA nixos.qv2ray`。在使用 `qv2ray` 的时候，需参照 https://qv2ray.net/lang/zh/getting-started/step2.html 配置其核心文件。\n\n#### 使用 AMD 显卡\n\n```\nhardware.opengl.extraPackages = [\n  rocm-opencl-icd\n  pkgs.amdvlk\n];\n```\n\n#### 使用 Intel Gen8 或更新的显卡\n\n```\nhardware.opengl.extraPackages = [\n  intel-compute-runtime\n];\n```\n\n#### 使用 NVIDIA 显卡\n\n<div class=\"warning\">\n\n> 警告：如果你正在为 Linux 选购硬件，除非特殊需要，请避免使用由 NVIDIA，Realtek，Broadcom 以及 Apple Inc 生产的设备。在这些公司所生产的硬件设备上部署 Linux 可能会非常棘手。\n\n</div>\n\n```nix\n  services.xserver.videoDrivers = [ \"nvidia\" ];\n```\n\n<div class=\"info\">\n\n> 提示：由于 NVIDIA 的驱动是非自由软件，你同时还需要在配置文件中使用 `  nixpkgs.config.allowUnfree = true;`启用非自由软件\n\n</div>\n\n#### 使用数位板\n\n```nix\n  services.xserver.wacom.enable = true;\n  services.xserver.digimend.enable = true;\n  hardware.opentabletdriver.enable = true;\n  hardware.opentabletdriver.daemon.enable = true;\n```\n\n#### 使用 Steam\n\n```\n  programs.steam.enable = true;\n```\n\n#### 使用 AppImage\n\n安装软件包 `appimage-run`\n\n#### 使用为常规 Linux 而编译的二进行程序\n\n安装软件包 `steam-run`\n\n#### 在 NixOS 中作为宿主时使用 VirtualBox\n\n```nix\n  virtualisation.virtualbox.host.enable = true;\n  users.extraGroups.vboxusers.members = [ \"<用户名>\" ];\n```\n\n#### 在 NixOS 中作为宿主时使用 KVM\n\n```nix\n  virtualisation.libvirtd.qemu.package = pkgs.qemu_kvm;\n  virtualisation.libvirtd.enable = true;\n```\n\n#### 使用 Flatpak\n\n<div class=\"warning\">\n\n>如果你这 Flatpak 安装了有中文的软件，请在 `~/.local/share/fonts/` 目录里放几个中文字体，否则中文无法正常显示\n\n</div>\n\n```nix\n  services.flatpak.enable = true;\n```\n\n> 提示：如果你使用非 GNOME 的桌面环境，你还需要配置\n>\n> ```nix\n> xdg.portal.extraPortals = [ pkgs.xdg-desktop-portal-gtk ];\n> ```\n\n在启用 flatpak 之后，需要导入 flathub 源：\n\n```shell\nflatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo\nflatpak update\n```\n#### 开启支持 NTFS 读写\n\n<div class=\"warning\">\n\n> 如果你有使用 NTFS 格式的硬盘，在 `configuration.nix` 中加入以下字段来提供 NTFS 的支持\n\n```nix\nboot.supportedFilesystems = [ \"ntfs\" ];\n```\n\n</div>\n\n#### 使用 Docker\n\n```nix\n  virtualisation.docker.enable = true;\n```\n\n此外，你还需要将用户加入 \"docker\" 用户组\n\n#### 使用其他 Linux 内核\n\n`Packages` 选项来指定 NixOS 使用的内核。例如：使用 `linux-zen`\n\n```nix\n  boot.kernelPackages = pkgs.linuxPackages_zen;\n```\n\n#### 使用中国的 Nix 二进制源\n\n```nix\n  nix.settings.substituters = [ \"https://mirrors.ustc.edu.cn/nix-channels/store\" ];\n```\n<div class=\"warning\">\n\n> 注意\n>\n> 在NixOS 21.11中，不存在 `nix.settings` 段\n>\n> 所以如果你安装的是NixOS 21.11，要改成下面这样：\n>\n> `nix.binaryCaches = [ \"https://mirrors.ustc.edu.cn/nix-channels/store\" ];`\n\n</div>\n\n### 安装 NixOS\n\n```bash\nnixos-install --root /mnt\n```\n\n## 重启\n\n<div class=\"success\">\n\n> 到这里，我们的LiveCD的安装步骤就完成了，曙光就在眼前了！接下来我们重启就可以进入你配置好的NixOS\n\n</div>\n\n","slug":"nixos-guide-cn","published":1,"updated":"2022-06-18T15:50:46.668Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4k28bs90000trgq5h3z18jw","content":"<h1 align=\"center\">\n  <img src=\"https://pic.lanta.cyou/img/nix-snowflake.svg\" width=\"200\">\n  <br>NixOS<br>\n</h1>\n\n<div class=\"info\">\n\n\n<blockquote>\n<p>非常感谢<a href=\"https://github.com/YisuiDenghua\">一穂灯花</a>在我安装NixOS中提供的帮助，以完成我对NixOS的学习和本文章的创作</p>\n</blockquote>\n</div>\n\n\n<h1 id=\"NixOS-适合我吗？\"><a href=\"#NixOS-适合我吗？\" class=\"headerlink\" title=\"NixOS 适合我吗？\"></a>NixOS 适合我吗？</h1><blockquote>\n<p>「如果你不需要 Ubuntu 那种的开箱即用的，觉得 Arch 那样的自己动手可以接受，喜欢 Gentoo 的可配置性，又不想自己完全编译整个世界，并且觉得所有系统配置全都由统一格式写出来的可复现性确实很棒，并且觉得那帮人为了 portable 和轻量级，自己做了个 Nix 语言可以接受的话，NixOS 可能就是专门为你设计的。」—— <a href=\"https://github.com/dramforever\">Dramforever</a>，NixOS 中文社区管理员之一</p>\n</blockquote>\n<h1 id=\"前排提示\"><a href=\"#前排提示\" class=\"headerlink\" title=\"前排提示\"></a>前排提示</h1><p>由于 NixOS 系统的配置，操作方式和传统的 Linux 发行版有很大不同，建议新手在先在虚拟机中试用 NixOS，等到熟悉了之后，将 configuration.nix 等配置文件导出，而后能够在宿主机上使用相同的配置复现出一个一样的 NixOS。</p>\n<p>在安装的时候，建议新人阅读 NixOS 自带的手册 NixOS Manual，以及在 <a href=\"search.nixos.org\">search.nixos.org</a> 上查询软件包名（Packages）和配置语句（Options）</p>\n<blockquote>\n<p>永远不要想着用常规 Linux 方式在 NixOS 上安装软件。因为 NixOS 不遵守 fhs，也就是说，它的根目录结构和常规的 Linux 是不一样的。不信你看看，NixOS 的 &#x2F;bin 下什么都没有。—— <a href=\"https://github.com/YisuiDenghua\">一穂灯花</a></p>\n</blockquote>\n<h1 id=\"认识NixOS\"><a href=\"#认识NixOS\" class=\"headerlink\" title=\"认识NixOS\"></a>认识NixOS</h1><p>NixOS 是一个基于 Nix 包管理器和 Nix 构建系统的 Linux 发行版。它支持可重现和声明性的系统配置管理以及事务回滚，它也支持命令式的软件包和用户管理。在 NixOS 中，发行版的所有组件——包括内核，安装的包和系统配置文件都是由 Nix 表达式构建的。</p>\n<h2 id=\"软件包的安装方式\"><a href=\"#软件包的安装方式\" class=\"headerlink\" title=\"软件包的安装方式\"></a>软件包的安装方式</h2><p>NixOS 非常不同，如果你想安装软件，有多种安装方式，这里举三个例子</p>\n<ol>\n<li>声明式的软件包管理（编辑 NixOS 的配置文件<code>/etc/nixos/configuration.nix</code>）</li>\n</ol>\n<div class=\"info\">\n\n\n<blockquote>\n<p>安装在<code>configuration.nix</code>的软件就是构建在系统里面了，而且因为在配置文件里面，下次你要安装NixOS到其他电脑，只要用这个配置文件（可能需要稍微修改一下）就可以轻松安装NixOS顺便安装你需要的软件了</p>\n<p>比如说我需要装git，把 git 写进<code>configuration.nix</code></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">environment.<span class=\"attr\">systemPackages</span> = <span class=\"keyword\">with</span> pkgs; [ </span><br><span class=\"line\">git</span><br><span class=\"line\">];  </span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>nixos-rebuild boot</code>重启就可以安装完成</p>\n<p>缺点是，需要重启（因为重构了部分系统文件），不过重构的时间并不多，基本上几分钟就可以了</p>\n</blockquote>\n</div>\n\n<div class=\"warning\">\n\n\n<blockquote>\n<p>需要注意的是，有一些软件的开源协议是<strong>不自由</strong>的，所以NixOS会阻止你的安装操作</p>\n<p>要解决这个问题也很简单，只要在<code>configuration.nix</code>中允许即可，在里面加入<code>nixpkgs.config.allowUnfree = true;</code></p>\n<p>例如：</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-45.png\"></p>\n</blockquote>\n</div>\n\n<p>2.<code>nix-shell</code>临时使用</p>\n<div class=\"info\">\n\n\n<blockquote>\n<p><code>nix-shell</code>的安装是临时使用，比如我要临时用一下git，那就<code>nix-shell -p git</code></p>\n<p>随后，你会进入一个 nix-shell，在这个 nix-shell 当中，你可以使用 git。当你用 <code>exit</code>退出 nix-shell 之后，git 就不再可用。</p>\n</blockquote>\n</div>\n\n<ol start=\"3\">\n<li>命令式的软件包管理（<code>nix-env -iA nixos.&lt;包名&gt;</code>）</li>\n</ol>\n<div class=\"warning\">\n\n<blockquote>\n<p>不推荐使用这种方式安装软件</p>\n</blockquote>\n</div>\n\n<div class=\"info\">\n\n\n<blockquote>\n<p>这种不需要 sudo，也不需要重构，它是把软件安装在用户的目录下</p>\n<p>缺点是，这种方式安装的软件不能被 configuration.nix 记录，也不能被其他用户使用</p>\n<p>——<a href=\"https://github.com/YisuiDenghua\">一穂灯花</a></p>\n</blockquote>\n</div>\n\n<h2 id=\"NixOS-的配置是可复现的\"><a href=\"#NixOS-的配置是可复现的\" class=\"headerlink\" title=\"NixOS 的配置是可复现的\"></a>NixOS 的配置是可复现的</h2><p>NixOS跟其他Linux发行版最大的不同就是，NixOS 的配置是可复现的。几乎所有的系统设置都在<code>configuration.nix</code></p>\n<p>例如，添加用户、安装的软件、字体、网络、系统引导、桌面环境，全部包含在了这么一个文件里面。而不是像其他发行版那样，配置文件散落在系统各处。</p>\n<p>也就是说，只要你在<code>configuration.nix</code>配置好之后，下次你需要安装到其他电脑只要再用这个配置文件然后<code>nixos-install</code>就可以得到一模一样的NixOS。</p>\n<p>同理，如果你去Github下载别人的<code>configuration.nix</code>，你可以得到跟他们一模一样的NixOS</p>\n<blockquote>\n<p> 笔者的<a href=\"https://github.com/RealLanta/nixos-config\"><code>configuration.nix</code></a></p>\n</blockquote>\n<h1 id=\"准备操作\"><a href=\"#准备操作\" class=\"headerlink\" title=\"准备操作\"></a>准备操作</h1><p>首先你需要确保你的网络畅通，NixOS是<strong>在线安装</strong>。也就是说，安装的过程需要保持网络连接。</p>\n<h2 id=\"下载LiveCD\"><a href=\"#下载LiveCD\" class=\"headerlink\" title=\"下载LiveCD\"></a>下载LiveCD</h2><p>你可以前往<a href=\"https://mirrors.tuna.tsinghua.edu.cn/nixos-images/\">清华大学开源软件镜像站</a>中下载NixOS的Live CD</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-47.png\"></p>\n<div class=\"warning\">\n\n\n<blockquote>\n<p>请尽量下载较新的版本</p>\n</blockquote>\n</div>\n\n<p>里面有很多个镜像，这里做一下解释</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-50.png\"></p>\n<h2 id=\"刻录到U盘\"><a href=\"#刻录到U盘\" class=\"headerlink\" title=\"刻录到U盘\"></a>刻录到U盘</h2><p>你可以使用以下几种方式来将NixOS镜像刻录到U盘中</p>\n<div class=\"danger\">\n\n\n\n<blockquote>\n<p>刻录到U盘会导致数据丢失，请在操作之前备份好你的U盘数据</p>\n</blockquote>\n</div>\n\n<div class=\"warning\">\n\n<blockquote>\n<p>警告：Ventoy 的硬件支持比较有限。在使用 Ventoy 前，需先阅读其官网的文档，以了解硬件支持情况</p>\n</blockquote>\n</div>\n\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>使用方式</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://ventoy.net/\">Ventoy</a></td>\n<td>将Ventoy安装到U盘后直接把ISO文件复制到U盘中即可</td>\n<td>一次安装，一盘多用</td>\n</tr>\n<tr>\n<td><a href=\"https://rufus.ie/\">Rufus</a></td>\n<td>选择ISO文件然后选择U盘直接刻录即可</td>\n<td>注意选择引导方式</td>\n</tr>\n<tr>\n<td><a href=\"https://www.balena.io/etcher/\">balenaEtcher</a></td>\n<td>选择ISO文件然后选择U盘点击Flash开始刻录</td>\n<td>最简单的方法</td>\n</tr>\n</tbody></table>\n<h2 id=\"确定分区（必要）\"><a href=\"#确定分区（必要）\" class=\"headerlink\" title=\"确定分区（必要）\"></a>确定分区（必要）</h2><p>在纯文字的环境中你可能<strong>很难分辨</strong>分区，如果<strong>操作失误</strong>（删错分区）<del>则删库跑路</del></p>\n<p>所以我建议你<strong>事先</strong>在Windows环境中<strong>确定</strong>要安装的系统分区，以确保不会出现失误导致的<del>数据灰飞烟灭</del></p>\n<h2 id=\"引导设置（UEFI用户）\"><a href=\"#引导设置（UEFI用户）\" class=\"headerlink\" title=\"引导设置（UEFI用户）\"></a>引导设置（UEFI用户）</h2><p>进入BIOS中，如果你是有UEFI的电脑那么你应该能看到带有<strong>CSM</strong>字样的选项，将他<strong>Disable</strong>掉</p>\n<p>还有一些电脑带有<strong>Secure Boot（安全启动）</strong>，找到<strong>Secure Boot</strong>的字样<strong>Disable</strong>即可</p>\n<h2 id=\"重启开始安装\"><a href=\"#重启开始安装\" class=\"headerlink\" title=\"重启开始安装\"></a>重启开始安装</h2><p>确保您的U盘已经写入了镜像、分区已经确定好没问题之后就可以重启进入LiveCD</p>\n<h1 id=\"LiveCD\"><a href=\"#LiveCD\" class=\"headerlink\" title=\"LiveCD\"></a>LiveCD</h1><h2 id=\"进入NixOS的root\"><a href=\"#进入NixOS的root\" class=\"headerlink\" title=\"进入NixOS的root\"></a>进入NixOS的root</h2><p>进入终端后你会发现NixOS默认登录的不是root账户，首先你需要登录到root账户才能继续</p>\n<p>打开终端，输入<code>sudo -i</code>即可进入root账户</p>\n<h2 id=\"确保网络畅通\"><a href=\"#确保网络畅通\" class=\"headerlink\" title=\"确保网络畅通\"></a>确保网络畅通</h2><p>前面提到，NixOS是在线安装方式，所以你必须要确保LiveCD中的系统已经连接到了网络</p>\n<h3 id=\"有线网络\"><a href=\"#有线网络\" class=\"headerlink\" title=\"有线网络\"></a>有线网络</h3><p>一般来说如果你使用了带桌面环境的ISO就已经可以自动联网</p>\n<p>不过发现网络出现玄学问题，你可以执行<code>systemctl restart dhcpcd</code>来重启DHCP服务让Live CD重新获取IP</p>\n<h3 id=\"WiFi连接\"><a href=\"#WiFi连接\" class=\"headerlink\" title=\"WiFi连接\"></a>WiFi连接</h3><p>提供了 GUI 的 LiveCD 中自带 NetworkManager，你可以一步一步让Live CD连接到WiFi</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@nixos ~]<span class=\"comment\"># nmcli device wifi connect &lt;WIFI名&gt; password &lt;密码&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>然而，在最小化的纯命令行安装镜像中，NetworkManager 不是可用的，所以必须手动配置网络。要配置 WiFi，首先使用 <code>sudo systemctl start wpa_supplicant</code>，然后运行 <code>wpa_cli</code>。对于大多数家庭网络，你需要像这样输入命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">add_network</span></span><br><span class=\"line\">0</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 ssid <span class=\"string\">&quot;我的网络名称&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 psk <span class=\"string\">&quot;我的密码&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 key_mgmt WPA-PSK</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">enable_network 0</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>对于企业网络，例如 <em>eduroam</em>，应该这样做：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">add_network</span></span><br><span class=\"line\">0</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 ssid <span class=\"string\">&quot;eduroam&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 identity <span class=\"string\">&quot;myname@example.com&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 password <span class=\"string\">&quot;mypassword&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 key_mgmt WPA-EAP</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">enable_network 0</span></span><br><span class=\"line\">OK</span><br></pre></td></tr></table></figure>\n\n<p>一旦成功连接，你会看到这样的提示：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;3&gt;CTRL-EVENT-CONNECTED - Connection to 32:85:ab:ef:24:5c completed [id=0 id_str=]</span><br></pre></td></tr></table></figure>\n\n<p>现在，你可以通过输入 <code>quit</code>来离开<code>wpa_cli</code>。</p>\n<blockquote>\n<p>提示：如果你想要在另一台机器上远程安装，你可以在联网之后，使用<code>systemctl start sshd</code> 激活 OpenSSH 守护程序 。另外，你还必须使用 <code>passwd</code> 为 root 用户或 nixos （livecd 的默认用户）设置密码。</p>\n</blockquote>\n<h2 id=\"分区\"><a href=\"#分区\" class=\"headerlink\" title=\"分区\"></a>分区</h2><p>先通过<code>lsblk</code>或<code>fdisk -l</code>的方式确定硬盘，出现<code>/dev/某某某</code>的就是这个硬盘的设备名，记住硬盘的设备名，等会要用到</p>\n<h3 id=\"分区的工具\"><a href=\"#分区的工具\" class=\"headerlink\" title=\"分区的工具\"></a>分区的工具</h3><p>LiveCD中有<code>parted</code>、<code>fdisk</code>、<code>cfdisk</code>等工具，前两个比较麻烦，<code>cfdisk</code>拥有半图形界面，更适合新手使用</p>\n<p>如果使用带有 GUI 的 livecd，则 <code>gparted</code> 也是可用的。这里以 cfdisk 为例：</p>\n<p>首先我们要打开cfdisk</p>\n<div class=\"info\">\n\n\n\n<blockquote>\n<p>设sdX为你的硬盘号</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cfdisk /dev/sdX <span class=\"comment\"># 后面这个就是硬盘设备名</span></span><br></pre></td></tr></table></figure>\n\n<p>然后就会出现一个界面，这里以一个中文化的界面作为对照</p>\n<p><img src=\"https://pic.lanta.cyou/img/20220326033131.png\"></p>\n<h3 id=\"分区格式\"><a href=\"#分区格式\" class=\"headerlink\" title=\"分区格式\"></a>分区格式</h3><div class=\"info\">\n\n\n\n<blockquote>\n<p> 用户资料分区是可选的，可以将用户资料存放在系统盘中</p>\n</blockquote>\n</div>\n\n<h4 id=\"MBR（传统引导）推荐分区格式：\"><a href=\"#MBR（传统引导）推荐分区格式：\" class=\"headerlink\" title=\"MBR（传统引导）推荐分区格式：\"></a>MBR（传统引导）推荐分区格式：</h4><table>\n<thead>\n<tr>\n<th>用途</th>\n<th>文件系统</th>\n<th>分区推荐大小</th>\n<th>挂载点</th>\n<th>文章中的分区号</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>系统分区</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;</td>\n<td>&#x2F;dev&#x2F;sda2</td>\n</tr>\n<tr>\n<td>用户资料分区（可选）</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;home</td>\n<td>（本文章中没有设置用户资料分区）</td>\n</tr>\n</tbody></table>\n<h4 id=\"GPT（UEFI引导）推荐分区格式：\"><a href=\"#GPT（UEFI引导）推荐分区格式：\" class=\"headerlink\" title=\"GPT（UEFI引导）推荐分区格式：\"></a>GPT（UEFI引导）推荐分区格式：</h4><div class=\"danger\">\n\n\n\n<blockquote>\n<p>如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区删掉重建，否则会导致原来的系统无法进入！</p>\n</blockquote>\n</div>\n\n<div class=\"danger\">\n\n\n\n<blockquote>\n<p>因为某些机制的原因，请记得在<code>cfdisk</code>中把引导分区的“类型”(Type)改为”EFI System”</p>\n</blockquote>\n</div>\n\n<table>\n<thead>\n<tr>\n<th>用途</th>\n<th>文件系统</th>\n<th>分区推荐大小</th>\n<th>挂载点</th>\n<th>文章中的分区号</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>引导分区</td>\n<td>FAT32</td>\n<td>300MiB</td>\n<td>&#x2F;efi</td>\n<td>&#x2F;dev&#x2F;sda1</td>\n</tr>\n<tr>\n<td>系统分区</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;</td>\n<td>&#x2F;dev&#x2F;sda2</td>\n</tr>\n<tr>\n<td>用户资料分区（可选）</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;home</td>\n<td>（本文章中没有设置用户资料分区）</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>提示：如果你选择将 EFI 引导分区挂载到不是 <code>/boot</code> 的挂载点，例如 <code>/efi</code>，你还需要在接下来编辑 <code>configuration.nix</code> 的时候写入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.loader.efi.efiSysMountPoint = &quot;/efi&quot;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>其中，<code>/efi</code>可以替换为你所使用的挂载点</p>\n</blockquote>\n<h2 id=\"格式化分区\"><a href=\"#格式化分区\" class=\"headerlink\" title=\"格式化分区\"></a>格式化分区</h2><div class=\"danger\">\n\n\n\n<blockquote>\n<p>如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区格式化，否则会导致原来的系统无法进入！</p>\n</blockquote>\n</div>\n\n<div class=\"info\">\n\n\n\n<blockquote>\n<p>设引导分区为 &#x2F;dev&#x2F;sda1，系统分区为 &#x2F;dev&#x2F;sda2</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkfs.ext4 /dev/sda2 <span class=\"comment\"># 格式化 /dev/sda2 为 ext4 文件系统（系统分区或用户资料分区）</span></span><br><span class=\"line\">mkfs.vfat /dev/sda1 <span class=\"comment\"># 格式化 /dev/sda1 为 FAT32 文件系统（引导分区）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"挂载分区\"><a href=\"#挂载分区\" class=\"headerlink\" title=\"挂载分区\"></a>挂载分区</h2><h3 id=\"GPT\"><a href=\"#GPT\" class=\"headerlink\" title=\"GPT\"></a>GPT</h3><div class=\"info\">\n\n\n\n<blockquote>\n<p>设引导分区为 &#x2F;dev&#x2F;sda1，系统分区为 &#x2F;dev&#x2F;sda2，用户资料分区为&#x2F;dev&#x2F;sda3</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount /dev/sda2 /mnt <span class=\"comment\"># 挂载系统分区到 /mnt( / 分区)</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /mnt/boot /mnt/home <span class=\"comment\"># 新建 /mnt/boot 文件夹和 /mnt/home 文件夹</span></span><br><span class=\"line\">mount /dev/sda1 /mnt/boot <span class=\"comment\"># 挂载引导分区到 /mnt/boot</span></span><br><span class=\"line\">mount /dev/sda3 /mnt/home <span class=\"comment\"># 挂载用户资料分区到 /mnt/home （ /home 分区，在有用户资料分区的情况下才执行）</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MBR\"><a href=\"#MBR\" class=\"headerlink\" title=\"MBR\"></a>MBR</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount /dev/sda1 /mnt  <span class=\"comment\"># 挂载系统分区到 /mnt( / 分区)</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /mnt/home <span class=\"comment\"># 创建 /mnt/home 文件夹</span></span><br><span class=\"line\">mount /dev/sda2 /mnt/home <span class=\"comment\"># 挂载用户资料分区到 /mnt/home( /home 分区，在有用户资料分区的情况下才执行)</span></span><br></pre></td></tr></table></figure>\n\n<p>（以上文段参考了<a href=\"https://chitang.tech/posts/arch-guide/#%E6%8C%82%E8%BD%BD\">Chi_Tang的博客</a>并进行修改）</p>\n<h2 id=\"安装本体到硬盘\"><a href=\"#安装本体到硬盘\" class=\"headerlink\" title=\"安装本体到硬盘\"></a>安装本体到硬盘</h2><h3 id=\"使用中国的-nix-channel\"><a href=\"#使用中国的-nix-channel\" class=\"headerlink\" title=\"使用中国的 nix-channel\"></a>使用中国的 nix-channel</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nix-channel --add https://mirrors.ustc.edu.cn/nix-channels/nixos-unstable nixos</span><br><span class=\"line\">nix-channel --update</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"生成配置文件\"><a href=\"#生成配置文件\" class=\"headerlink\" title=\"生成配置文件\"></a>生成配置文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># nixos-generate-config --root /mnt</span></span><br></pre></td></tr></table></figure>\n\n<p>该命令会生成配置文件到<code>/mnt/etc/nixos/</code>目录中，里面包括了硬件配置文件(<code>hardware-configuration.nix</code>)和<code>configuration.nix</code></p>\n<p>如果你有自己配置好的<code>configuration.nix</code>只要替换掉即可</p>\n<blockquote>\n<p>提示：在修改 NixOS 配置文件的时候要注意缩进及分号 <code>;</code> 的使用。<code>configuration.nix</code> 当中已经存在一些默认配置好的语句，可以参考它们的格式。</p>\n</blockquote>\n<h3 id=\"更改配置文件\"><a href=\"#更改配置文件\" class=\"headerlink\" title=\"更改配置文件\"></a>更改配置文件</h3><blockquote>\n<p>「古人云：『知其然，知其所以然。（宋・朱熹《建宁府建阳县长滩社仓记》）』意思是说，在知道事物的表面现象的同时，更应去探明事物的本质及其产生的原因。同样的道理可以应用在 Nix 上。在配置 NixOS 的时候，总抄作业可不是好习惯。抄袭其他人的配置文件能够满足用户一时的使用，但此时的用户仍然没有了解 Nix 的设置方法，当用户真正有自己需求的时候，仍然不知该怎么做。相比起抄袭其他人配置文件，我更希望用户阅读 NixOS 自带的手册 NixOS Manual，以及在 <a href=\"search.nixos.org\">search.nixos.org</a> 上查询软件包名（Packages）和配置语句（Options）。这样，用户能真正学到 NixOS 独特的声明式配置方式的精髓。」 ——<a href=\"github.con/YisuiDenghua\">一穗灯花</a></p>\n</blockquote>\n<p>使用vim开始编辑</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /mnt/etc/nixos/configuration.nix</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"允许安装不自由的软件\"><a href=\"#允许安装不自由的软件\" class=\"headerlink\" title=\"允许安装不自由的软件\"></a>允许安装不自由的软件</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixpkgs.config.<span class=\"attr\">allowUnfree</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-15.png\"></p>\n<h4 id=\"安装NotoFonts字体以显示中文和其他特殊字符\"><a href=\"#安装NotoFonts字体以显示中文和其他特殊字符\" class=\"headerlink\" title=\"安装NotoFonts字体以显示中文和其他特殊字符\"></a>安装NotoFonts字体以显示中文和其他特殊字符</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fonts.<span class=\"attr\">fonts</span> = <span class=\"keyword\">with</span> pkgs; [</span><br><span class=\"line\">  noto-fonts</span><br><span class=\"line\">  noto-fonts-cjk</span><br><span class=\"line\">  noto-fonts-emoji</span><br><span class=\"line\">  meslo-lgs-nf</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-16.png\"></p>\n<h4 id=\"设置时区\"><a href=\"#设置时区\" class=\"headerlink\" title=\"设置时区\"></a>设置时区</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">time.<span class=\"attr\">timeZone</span> = <span class=\"string\">&quot;Asia/Shanghai&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-16_1.png\"></p>\n<h4 id=\"使用NetworkManager联网\"><a href=\"#使用NetworkManager联网\" class=\"headerlink\" title=\"使用NetworkManager联网\"></a>使用NetworkManager联网</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">networking.networkmanager.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/20220506104638.png\"></p>\n<h4 id=\"设置中文\"><a href=\"#设置中文\" class=\"headerlink\" title=\"设置中文\"></a>设置中文</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i18n.<span class=\"attr\">defaultLocale</span> = <span class=\"string\">&quot;zh_CN.UTF-8&quot;</span>;</span><br><span class=\"line\">i18n.inputMethod.<span class=\"attr\">enabled</span> = <span class=\"string\">&quot;fcitx5&quot;</span>;</span><br><span class=\"line\">i18n.inputMethod.fcitx5.<span class=\"attr\">addons</span> = <span class=\"keyword\">with</span> pkgs; [ fcitx5-rime ];</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：这里使用 <code>fcitx5-rime </code>作为示例。用户可以将其替换为 <code>fcitx5-chinese-addons</code> 等其他输入法。</p>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-19.png\"></p>\n<h4 id=\"设置桌面环境\"><a href=\"#设置桌面环境\" class=\"headerlink\" title=\"设置桌面环境\"></a>设置桌面环境</h4><p>如果你使用的是Plasma，那么生成配置文件的时候会自动帮你设置好Plasma，Gnome用户同理。这里以 KDE Plasma 和 GNU GNOME 为例：</p>\n<div class=\"warning\">\n\n<blockquote>\n<p>警告：在 NixOS 上，无法同时启用 GNOME 和 KDE Plasma。</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 如果要使用 GNOME：</span></span><br><span class=\"line\">services.xserver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.displayManager.gdm.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.desktopManager.gnome.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 如果要使用 KDE Plasma</span></span><br><span class=\"line\">services.xserver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.displayManager.sddm.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.desktopManager.plasma5.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：如果想要启用 Plasma 的 Qt 缩放，你还需要添加一条语句：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.desktopManager.plasma5.useQtScaling = true;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-20.png\"></p>\n<h4 id=\"设置普通用户\"><a href=\"#设置普通用户\" class=\"headerlink\" title=\"设置普通用户\"></a>设置普通用户</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">users.users.&lt;用户名&gt; = &#123;</span><br><span class=\"line\">  <span class=\"attr\">isNormalUser</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"attr\">shell</span> = pkgs.zsh;</span><br><span class=\"line\">  <span class=\"attr\">extraGroups</span> = [ <span class=\"string\">&quot;wheel&quot;</span> ]; <span class=\"comment\"># Enable ‘sudo’ for the user.</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示，如果你的用户要使用图形界面，你还需要将 <code>&quot;video&quot;</code> 加入到  <code>extraGroups = [  ];  </code> 当中；如果你的用户要使用 <code>docker</code>，你还需要将<code>&quot;docker&quot;</code>加入语句中。如果你不想给用户使用 <code>sudo</code> 的权利，将  <code>&quot;wheel&quot; </code> 从上述语句中移除。</p>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-22.png\"></p>\n<h4 id=\"设置安装的软件\"><a href=\"#设置安装的软件\" class=\"headerlink\" title=\"设置安装的软件\"></a>设置安装的软件</h4><p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-25.png\"></p>\n<h4 id=\"开启SSH（可选）\"><a href=\"#开启SSH（可选）\" class=\"headerlink\" title=\"开启SSH（可选）\"></a>开启SSH（可选）</h4><p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-26.png\"></p>\n<h3 id=\"提示：用户的特殊需求\"><a href=\"#提示：用户的特殊需求\" class=\"headerlink\" title=\"提示：用户的特殊需求\"></a>提示：用户的特殊需求</h3><p>对于某些有特殊需求的用户，需要在安装之前按需修改配置文件。</p>\n<h4 id=\"使用-NUR\"><a href=\"#使用-NUR\" class=\"headerlink\" title=\"使用 NUR\"></a>使用 NUR</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixpkgs.config.packageOverrides = pkgs: &#123;</span><br><span class=\"line\">  nur = import (builtins.fetchTarball &quot;https://github.com/nix-community/NUR/archive/master.tar.gz&quot;) &#123;</span><br><span class=\"line\">    inherit pkgs;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;;  </span><br><span class=\"line\">  </span><br></pre></td></tr></table></figure>\n\n<p>而后，可以在 <a href=\"https://nur.nix-community.org/\">https://nur.nix-community.org/</a> 上搜索 NUR 软件包，例如微信。然后，可以使用声明式的方式安装：</p>\n<p><img src=\"https://pic.lanta.cyou/img/photo_2022-05-06_13-49-27.jpg\"></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">environment.<span class=\"attr\">systemPackages</span> = <span class=\"keyword\">with</span> pkgs; [</span><br><span class=\"line\">  nur.repos.xddxdd.wechat-uos-bin</span><br><span class=\"line\"> ];</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：由于 NUR 使用 <a href=\"github.com\">GitHub</a> 来托管软件包代码，而 GitHub 在国内的某些地区连接不佳，你可能还需要在安装之前配置代理。</p>\n<p>可以通过 <code>nix-env -iA nixos.v2ray</code> 在安装 LiveCD 里临时安装 <code>v2ray</code>。对于带有 GUI 的 LiveCD，可使用 <code>nix-env -iA nixos.qv2ray</code>。在使用 <code>qv2ray</code> 的时候，需参照 <a href=\"https://qv2ray.net/lang/zh/getting-started/step2.html\">https://qv2ray.net/lang/zh/getting-started/step2.html</a> 配置其核心文件。</p>\n</blockquote>\n<h4 id=\"使用-AMD-显卡\"><a href=\"#使用-AMD-显卡\" class=\"headerlink\" title=\"使用 AMD 显卡\"></a>使用 AMD 显卡</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hardware.opengl.extraPackages = [</span><br><span class=\"line\">  rocm-opencl-icd</span><br><span class=\"line\">  pkgs.amdvlk</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Intel-Gen8-或更新的显卡\"><a href=\"#使用-Intel-Gen8-或更新的显卡\" class=\"headerlink\" title=\"使用 Intel Gen8 或更新的显卡\"></a>使用 Intel Gen8 或更新的显卡</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hardware.opengl.extraPackages = [</span><br><span class=\"line\">  intel-compute-runtime</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-NVIDIA-显卡\"><a href=\"#使用-NVIDIA-显卡\" class=\"headerlink\" title=\"使用 NVIDIA 显卡\"></a>使用 NVIDIA 显卡</h4><div class=\"warning\">\n\n<blockquote>\n<p>警告：如果你正在为 Linux 选购硬件，除非特殊需要，请避免使用由 NVIDIA，Realtek，Broadcom 以及 Apple Inc 生产的设备。在这些公司所生产的硬件设备上部署 Linux 可能会非常棘手。</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.<span class=\"attr\">videoDrivers</span> = [ <span class=\"string\">&quot;nvidia&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n<div class=\"info\">\n\n<blockquote>\n<p>提示：由于 NVIDIA 的驱动是非自由软件，你同时还需要在配置文件中使用 <code>  nixpkgs.config.allowUnfree = true;</code>启用非自由软件</p>\n</blockquote>\n</div>\n\n<h4 id=\"使用数位板\"><a href=\"#使用数位板\" class=\"headerlink\" title=\"使用数位板\"></a>使用数位板</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.wacom.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.digimend.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">hardware.opentabletdriver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">hardware.opentabletdriver.daemon.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Steam\"><a href=\"#使用-Steam\" class=\"headerlink\" title=\"使用 Steam\"></a>使用 Steam</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">programs.steam.enable = true;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-AppImage\"><a href=\"#使用-AppImage\" class=\"headerlink\" title=\"使用 AppImage\"></a>使用 AppImage</h4><p>安装软件包 <code>appimage-run</code></p>\n<h4 id=\"使用为常规-Linux-而编译的二进行程序\"><a href=\"#使用为常规-Linux-而编译的二进行程序\" class=\"headerlink\" title=\"使用为常规 Linux 而编译的二进行程序\"></a>使用为常规 Linux 而编译的二进行程序</h4><p>安装软件包 <code>steam-run</code></p>\n<h4 id=\"在-NixOS-中作为宿主时使用-VirtualBox\"><a href=\"#在-NixOS-中作为宿主时使用-VirtualBox\" class=\"headerlink\" title=\"在 NixOS 中作为宿主时使用 VirtualBox\"></a>在 NixOS 中作为宿主时使用 VirtualBox</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.virtualbox.host.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">users.extraGroups.vboxusers.<span class=\"attr\">members</span> = [ <span class=\"string\">&quot;&lt;用户名&gt;&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"在-NixOS-中作为宿主时使用-KVM\"><a href=\"#在-NixOS-中作为宿主时使用-KVM\" class=\"headerlink\" title=\"在 NixOS 中作为宿主时使用 KVM\"></a>在 NixOS 中作为宿主时使用 KVM</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.libvirtd.qemu.<span class=\"attr\">package</span> = pkgs.qemu_kvm;</span><br><span class=\"line\">virtualisation.libvirtd.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Flatpak\"><a href=\"#使用-Flatpak\" class=\"headerlink\" title=\"使用 Flatpak\"></a>使用 Flatpak</h4><div class=\"warning\">\n\n<blockquote>\n<p>如果你这 Flatpak 安装了有中文的软件，请在 <code>~/.local/share/fonts/</code> 目录里放几个中文字体，否则中文无法正常显示</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.flatpak.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：如果你使用非 GNOME 的桌面环境，你还需要配置</p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xdg.portal.<span class=\"attr\">extraPortals</span> = [ pkgs.xdg-desktop-portal-gtk ];</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>在启用 flatpak 之后，需要导入 flathub 源：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo</span><br><span class=\"line\">flatpak update</span><br></pre></td></tr></table></figure>\n<h4 id=\"开启支持-NTFS-读写\"><a href=\"#开启支持-NTFS-读写\" class=\"headerlink\" title=\"开启支持 NTFS 读写\"></a>开启支持 NTFS 读写</h4><div class=\"warning\">\n\n<blockquote>\n<p>如果你有使用 NTFS 格式的硬盘，在 <code>configuration.nix</code> 中加入以下字段来提供 NTFS 的支持</p>\n</blockquote>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.<span class=\"attr\">supportedFilesystems</span> = [ <span class=\"string\">&quot;ntfs&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n</div>\n\n<h4 id=\"使用-Docker\"><a href=\"#使用-Docker\" class=\"headerlink\" title=\"使用 Docker\"></a>使用 Docker</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.docker.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<p>此外，你还需要将用户加入 “docker” 用户组</p>\n<h4 id=\"使用其他-Linux-内核\"><a href=\"#使用其他-Linux-内核\" class=\"headerlink\" title=\"使用其他 Linux 内核\"></a>使用其他 Linux 内核</h4><p><code>Packages</code> 选项来指定 NixOS 使用的内核。例如：使用 <code>linux-zen</code></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.<span class=\"attr\">kernelPackages</span> = pkgs.linuxPackages_zen;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用中国的-Nix-二进制源\"><a href=\"#使用中国的-Nix-二进制源\" class=\"headerlink\" title=\"使用中国的 Nix 二进制源\"></a>使用中国的 Nix 二进制源</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nix.settings.<span class=\"attr\">substituters</span> = [ <span class=\"string\">&quot;https://mirrors.ustc.edu.cn/nix-channels/store&quot;</span> ];</span><br></pre></td></tr></table></figure>\n<div class=\"warning\">\n\n<blockquote>\n<p>注意</p>\n<p>在NixOS 21.11中，不存在 <code>nix.settings</code> 段</p>\n<p>所以如果你安装的是NixOS 21.11，要改成下面这样：</p>\n<p><code>nix.binaryCaches = [ &quot;https://mirrors.ustc.edu.cn/nix-channels/store&quot; ];</code></p>\n</blockquote>\n</div>\n\n<h3 id=\"安装-NixOS\"><a href=\"#安装-NixOS\" class=\"headerlink\" title=\"安装 NixOS\"></a>安装 NixOS</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixos-install --root /mnt</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"重启\"><a href=\"#重启\" class=\"headerlink\" title=\"重启\"></a>重启</h2><div class=\"success\">\n\n<blockquote>\n<p>到这里，我们的LiveCD的安装步骤就完成了，曙光就在眼前了！接下来我们重启就可以进入你配置好的NixOS</p>\n</blockquote>\n</div>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 align=\"center\">\n  <img src=\"https://pic.lanta.cyou/img/nix-snowflake.svg\" width=\"200\">\n  <br>NixOS<br>\n</h1>\n\n<div class=\"info\">\n\n\n<blockquote>\n<p>非常感谢<a href=\"https://github.com/YisuiDenghua\">一穂灯花</a>在我安装NixOS中提供的帮助，以完成我对NixOS的学习和本文章的创作</p>\n</blockquote>\n</div>\n\n\n<h1 id=\"NixOS-适合我吗？\"><a href=\"#NixOS-适合我吗？\" class=\"headerlink\" title=\"NixOS 适合我吗？\"></a>NixOS 适合我吗？</h1><blockquote>\n<p>「如果你不需要 Ubuntu 那种的开箱即用的，觉得 Arch 那样的自己动手可以接受，喜欢 Gentoo 的可配置性，又不想自己完全编译整个世界，并且觉得所有系统配置全都由统一格式写出来的可复现性确实很棒，并且觉得那帮人为了 portable 和轻量级，自己做了个 Nix 语言可以接受的话，NixOS 可能就是专门为你设计的。」—— <a href=\"https://github.com/dramforever\">Dramforever</a>，NixOS 中文社区管理员之一</p>\n</blockquote>\n<h1 id=\"前排提示\"><a href=\"#前排提示\" class=\"headerlink\" title=\"前排提示\"></a>前排提示</h1><p>由于 NixOS 系统的配置，操作方式和传统的 Linux 发行版有很大不同，建议新手在先在虚拟机中试用 NixOS，等到熟悉了之后，将 configuration.nix 等配置文件导出，而后能够在宿主机上使用相同的配置复现出一个一样的 NixOS。</p>\n<p>在安装的时候，建议新人阅读 NixOS 自带的手册 NixOS Manual，以及在 <a href=\"search.nixos.org\">search.nixos.org</a> 上查询软件包名（Packages）和配置语句（Options）</p>\n<blockquote>\n<p>永远不要想着用常规 Linux 方式在 NixOS 上安装软件。因为 NixOS 不遵守 fhs，也就是说，它的根目录结构和常规的 Linux 是不一样的。不信你看看，NixOS 的 &#x2F;bin 下什么都没有。—— <a href=\"https://github.com/YisuiDenghua\">一穂灯花</a></p>\n</blockquote>\n<h1 id=\"认识NixOS\"><a href=\"#认识NixOS\" class=\"headerlink\" title=\"认识NixOS\"></a>认识NixOS</h1><p>NixOS 是一个基于 Nix 包管理器和 Nix 构建系统的 Linux 发行版。它支持可重现和声明性的系统配置管理以及事务回滚，它也支持命令式的软件包和用户管理。在 NixOS 中，发行版的所有组件——包括内核，安装的包和系统配置文件都是由 Nix 表达式构建的。</p>\n<h2 id=\"软件包的安装方式\"><a href=\"#软件包的安装方式\" class=\"headerlink\" title=\"软件包的安装方式\"></a>软件包的安装方式</h2><p>NixOS 非常不同，如果你想安装软件，有多种安装方式，这里举三个例子</p>\n<ol>\n<li>声明式的软件包管理（编辑 NixOS 的配置文件<code>/etc/nixos/configuration.nix</code>）</li>\n</ol>\n<div class=\"info\">\n\n\n<blockquote>\n<p>安装在<code>configuration.nix</code>的软件就是构建在系统里面了，而且因为在配置文件里面，下次你要安装NixOS到其他电脑，只要用这个配置文件（可能需要稍微修改一下）就可以轻松安装NixOS顺便安装你需要的软件了</p>\n<p>比如说我需要装git，把 git 写进<code>configuration.nix</code></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">environment.<span class=\"attr\">systemPackages</span> = <span class=\"keyword\">with</span> pkgs; [ </span><br><span class=\"line\">git</span><br><span class=\"line\">];  </span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>nixos-rebuild boot</code>重启就可以安装完成</p>\n<p>缺点是，需要重启（因为重构了部分系统文件），不过重构的时间并不多，基本上几分钟就可以了</p>\n</blockquote>\n</div>\n\n<div class=\"warning\">\n\n\n<blockquote>\n<p>需要注意的是，有一些软件的开源协议是<strong>不自由</strong>的，所以NixOS会阻止你的安装操作</p>\n<p>要解决这个问题也很简单，只要在<code>configuration.nix</code>中允许即可，在里面加入<code>nixpkgs.config.allowUnfree = true;</code></p>\n<p>例如：</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-45.png\"></p>\n</blockquote>\n</div>\n\n<p>2.<code>nix-shell</code>临时使用</p>\n<div class=\"info\">\n\n\n<blockquote>\n<p><code>nix-shell</code>的安装是临时使用，比如我要临时用一下git，那就<code>nix-shell -p git</code></p>\n<p>随后，你会进入一个 nix-shell，在这个 nix-shell 当中，你可以使用 git。当你用 <code>exit</code>退出 nix-shell 之后，git 就不再可用。</p>\n</blockquote>\n</div>\n\n<ol start=\"3\">\n<li>命令式的软件包管理（<code>nix-env -iA nixos.&lt;包名&gt;</code>）</li>\n</ol>\n<div class=\"warning\">\n\n<blockquote>\n<p>不推荐使用这种方式安装软件</p>\n</blockquote>\n</div>\n\n<div class=\"info\">\n\n\n<blockquote>\n<p>这种不需要 sudo，也不需要重构，它是把软件安装在用户的目录下</p>\n<p>缺点是，这种方式安装的软件不能被 configuration.nix 记录，也不能被其他用户使用</p>\n<p>——<a href=\"https://github.com/YisuiDenghua\">一穂灯花</a></p>\n</blockquote>\n</div>\n\n<h2 id=\"NixOS-的配置是可复现的\"><a href=\"#NixOS-的配置是可复现的\" class=\"headerlink\" title=\"NixOS 的配置是可复现的\"></a>NixOS 的配置是可复现的</h2><p>NixOS跟其他Linux发行版最大的不同就是，NixOS 的配置是可复现的。几乎所有的系统设置都在<code>configuration.nix</code></p>\n<p>例如，添加用户、安装的软件、字体、网络、系统引导、桌面环境，全部包含在了这么一个文件里面。而不是像其他发行版那样，配置文件散落在系统各处。</p>\n<p>也就是说，只要你在<code>configuration.nix</code>配置好之后，下次你需要安装到其他电脑只要再用这个配置文件然后<code>nixos-install</code>就可以得到一模一样的NixOS。</p>\n<p>同理，如果你去Github下载别人的<code>configuration.nix</code>，你可以得到跟他们一模一样的NixOS</p>\n<blockquote>\n<p> 笔者的<a href=\"https://github.com/RealLanta/nixos-config\"><code>configuration.nix</code></a></p>\n</blockquote>\n<h1 id=\"准备操作\"><a href=\"#准备操作\" class=\"headerlink\" title=\"准备操作\"></a>准备操作</h1><p>首先你需要确保你的网络畅通，NixOS是<strong>在线安装</strong>。也就是说，安装的过程需要保持网络连接。</p>\n<h2 id=\"下载LiveCD\"><a href=\"#下载LiveCD\" class=\"headerlink\" title=\"下载LiveCD\"></a>下载LiveCD</h2><p>你可以前往<a href=\"https://mirrors.tuna.tsinghua.edu.cn/nixos-images/\">清华大学开源软件镜像站</a>中下载NixOS的Live CD</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-47.png\"></p>\n<div class=\"warning\">\n\n\n<blockquote>\n<p>请尽量下载较新的版本</p>\n</blockquote>\n</div>\n\n<p>里面有很多个镜像，这里做一下解释</p>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_09-50.png\"></p>\n<h2 id=\"刻录到U盘\"><a href=\"#刻录到U盘\" class=\"headerlink\" title=\"刻录到U盘\"></a>刻录到U盘</h2><p>你可以使用以下几种方式来将NixOS镜像刻录到U盘中</p>\n<div class=\"danger\">\n\n\n\n<blockquote>\n<p>刻录到U盘会导致数据丢失，请在操作之前备份好你的U盘数据</p>\n</blockquote>\n</div>\n\n<div class=\"warning\">\n\n<blockquote>\n<p>警告：Ventoy 的硬件支持比较有限。在使用 Ventoy 前，需先阅读其官网的文档，以了解硬件支持情况</p>\n</blockquote>\n</div>\n\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>使用方式</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://ventoy.net/\">Ventoy</a></td>\n<td>将Ventoy安装到U盘后直接把ISO文件复制到U盘中即可</td>\n<td>一次安装，一盘多用</td>\n</tr>\n<tr>\n<td><a href=\"https://rufus.ie/\">Rufus</a></td>\n<td>选择ISO文件然后选择U盘直接刻录即可</td>\n<td>注意选择引导方式</td>\n</tr>\n<tr>\n<td><a href=\"https://www.balena.io/etcher/\">balenaEtcher</a></td>\n<td>选择ISO文件然后选择U盘点击Flash开始刻录</td>\n<td>最简单的方法</td>\n</tr>\n</tbody></table>\n<h2 id=\"确定分区（必要）\"><a href=\"#确定分区（必要）\" class=\"headerlink\" title=\"确定分区（必要）\"></a>确定分区（必要）</h2><p>在纯文字的环境中你可能<strong>很难分辨</strong>分区，如果<strong>操作失误</strong>（删错分区）<del>则删库跑路</del></p>\n<p>所以我建议你<strong>事先</strong>在Windows环境中<strong>确定</strong>要安装的系统分区，以确保不会出现失误导致的<del>数据灰飞烟灭</del></p>\n<h2 id=\"引导设置（UEFI用户）\"><a href=\"#引导设置（UEFI用户）\" class=\"headerlink\" title=\"引导设置（UEFI用户）\"></a>引导设置（UEFI用户）</h2><p>进入BIOS中，如果你是有UEFI的电脑那么你应该能看到带有<strong>CSM</strong>字样的选项，将他<strong>Disable</strong>掉</p>\n<p>还有一些电脑带有<strong>Secure Boot（安全启动）</strong>，找到<strong>Secure Boot</strong>的字样<strong>Disable</strong>即可</p>\n<h2 id=\"重启开始安装\"><a href=\"#重启开始安装\" class=\"headerlink\" title=\"重启开始安装\"></a>重启开始安装</h2><p>确保您的U盘已经写入了镜像、分区已经确定好没问题之后就可以重启进入LiveCD</p>\n<h1 id=\"LiveCD\"><a href=\"#LiveCD\" class=\"headerlink\" title=\"LiveCD\"></a>LiveCD</h1><h2 id=\"进入NixOS的root\"><a href=\"#进入NixOS的root\" class=\"headerlink\" title=\"进入NixOS的root\"></a>进入NixOS的root</h2><p>进入终端后你会发现NixOS默认登录的不是root账户，首先你需要登录到root账户才能继续</p>\n<p>打开终端，输入<code>sudo -i</code>即可进入root账户</p>\n<h2 id=\"确保网络畅通\"><a href=\"#确保网络畅通\" class=\"headerlink\" title=\"确保网络畅通\"></a>确保网络畅通</h2><p>前面提到，NixOS是在线安装方式，所以你必须要确保LiveCD中的系统已经连接到了网络</p>\n<h3 id=\"有线网络\"><a href=\"#有线网络\" class=\"headerlink\" title=\"有线网络\"></a>有线网络</h3><p>一般来说如果你使用了带桌面环境的ISO就已经可以自动联网</p>\n<p>不过发现网络出现玄学问题，你可以执行<code>systemctl restart dhcpcd</code>来重启DHCP服务让Live CD重新获取IP</p>\n<h3 id=\"WiFi连接\"><a href=\"#WiFi连接\" class=\"headerlink\" title=\"WiFi连接\"></a>WiFi连接</h3><p>提供了 GUI 的 LiveCD 中自带 NetworkManager，你可以一步一步让Live CD连接到WiFi</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@nixos ~]<span class=\"comment\"># nmcli device wifi connect &lt;WIFI名&gt; password &lt;密码&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>然而，在最小化的纯命令行安装镜像中，NetworkManager 不是可用的，所以必须手动配置网络。要配置 WiFi，首先使用 <code>sudo systemctl start wpa_supplicant</code>，然后运行 <code>wpa_cli</code>。对于大多数家庭网络，你需要像这样输入命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">add_network</span></span><br><span class=\"line\">0</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 ssid <span class=\"string\">&quot;我的网络名称&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 psk <span class=\"string\">&quot;我的密码&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 key_mgmt WPA-PSK</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">enable_network 0</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>对于企业网络，例如 <em>eduroam</em>，应该这样做：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">add_network</span></span><br><span class=\"line\">0</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 ssid <span class=\"string\">&quot;eduroam&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 identity <span class=\"string\">&quot;myname@example.com&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 password <span class=\"string\">&quot;mypassword&quot;</span></span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">set_network 0 key_mgmt WPA-EAP</span></span><br><span class=\"line\">OK</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">enable_network 0</span></span><br><span class=\"line\">OK</span><br></pre></td></tr></table></figure>\n\n<p>一旦成功连接，你会看到这样的提示：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;3&gt;CTRL-EVENT-CONNECTED - Connection to 32:85:ab:ef:24:5c completed [id=0 id_str=]</span><br></pre></td></tr></table></figure>\n\n<p>现在，你可以通过输入 <code>quit</code>来离开<code>wpa_cli</code>。</p>\n<blockquote>\n<p>提示：如果你想要在另一台机器上远程安装，你可以在联网之后，使用<code>systemctl start sshd</code> 激活 OpenSSH 守护程序 。另外，你还必须使用 <code>passwd</code> 为 root 用户或 nixos （livecd 的默认用户）设置密码。</p>\n</blockquote>\n<h2 id=\"分区\"><a href=\"#分区\" class=\"headerlink\" title=\"分区\"></a>分区</h2><p>先通过<code>lsblk</code>或<code>fdisk -l</code>的方式确定硬盘，出现<code>/dev/某某某</code>的就是这个硬盘的设备名，记住硬盘的设备名，等会要用到</p>\n<h3 id=\"分区的工具\"><a href=\"#分区的工具\" class=\"headerlink\" title=\"分区的工具\"></a>分区的工具</h3><p>LiveCD中有<code>parted</code>、<code>fdisk</code>、<code>cfdisk</code>等工具，前两个比较麻烦，<code>cfdisk</code>拥有半图形界面，更适合新手使用</p>\n<p>如果使用带有 GUI 的 livecd，则 <code>gparted</code> 也是可用的。这里以 cfdisk 为例：</p>\n<p>首先我们要打开cfdisk</p>\n<div class=\"info\">\n\n\n\n<blockquote>\n<p>设sdX为你的硬盘号</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cfdisk /dev/sdX <span class=\"comment\"># 后面这个就是硬盘设备名</span></span><br></pre></td></tr></table></figure>\n\n<p>然后就会出现一个界面，这里以一个中文化的界面作为对照</p>\n<p><img src=\"https://pic.lanta.cyou/img/20220326033131.png\"></p>\n<h3 id=\"分区格式\"><a href=\"#分区格式\" class=\"headerlink\" title=\"分区格式\"></a>分区格式</h3><div class=\"info\">\n\n\n\n<blockquote>\n<p> 用户资料分区是可选的，可以将用户资料存放在系统盘中</p>\n</blockquote>\n</div>\n\n<h4 id=\"MBR（传统引导）推荐分区格式：\"><a href=\"#MBR（传统引导）推荐分区格式：\" class=\"headerlink\" title=\"MBR（传统引导）推荐分区格式：\"></a>MBR（传统引导）推荐分区格式：</h4><table>\n<thead>\n<tr>\n<th>用途</th>\n<th>文件系统</th>\n<th>分区推荐大小</th>\n<th>挂载点</th>\n<th>文章中的分区号</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>系统分区</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;</td>\n<td>&#x2F;dev&#x2F;sda2</td>\n</tr>\n<tr>\n<td>用户资料分区（可选）</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;home</td>\n<td>（本文章中没有设置用户资料分区）</td>\n</tr>\n</tbody></table>\n<h4 id=\"GPT（UEFI引导）推荐分区格式：\"><a href=\"#GPT（UEFI引导）推荐分区格式：\" class=\"headerlink\" title=\"GPT（UEFI引导）推荐分区格式：\"></a>GPT（UEFI引导）推荐分区格式：</h4><div class=\"danger\">\n\n\n\n<blockquote>\n<p>如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区删掉重建，否则会导致原来的系统无法进入！</p>\n</blockquote>\n</div>\n\n<div class=\"danger\">\n\n\n\n<blockquote>\n<p>因为某些机制的原因，请记得在<code>cfdisk</code>中把引导分区的“类型”(Type)改为”EFI System”</p>\n</blockquote>\n</div>\n\n<table>\n<thead>\n<tr>\n<th>用途</th>\n<th>文件系统</th>\n<th>分区推荐大小</th>\n<th>挂载点</th>\n<th>文章中的分区号</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>引导分区</td>\n<td>FAT32</td>\n<td>300MiB</td>\n<td>&#x2F;efi</td>\n<td>&#x2F;dev&#x2F;sda1</td>\n</tr>\n<tr>\n<td>系统分区</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;</td>\n<td>&#x2F;dev&#x2F;sda2</td>\n</tr>\n<tr>\n<td>用户资料分区（可选）</td>\n<td>ext4</td>\n<td>50GiB</td>\n<td>&#x2F;home</td>\n<td>（本文章中没有设置用户资料分区）</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>提示：如果你选择将 EFI 引导分区挂载到不是 <code>/boot</code> 的挂载点，例如 <code>/efi</code>，你还需要在接下来编辑 <code>configuration.nix</code> 的时候写入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.loader.efi.efiSysMountPoint = &quot;/efi&quot;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>其中，<code>/efi</code>可以替换为你所使用的挂载点</p>\n</blockquote>\n<h2 id=\"格式化分区\"><a href=\"#格式化分区\" class=\"headerlink\" title=\"格式化分区\"></a>格式化分区</h2><div class=\"danger\">\n\n\n\n<blockquote>\n<p>如果你之前已经在硬盘中另外装了其他使用UEFI引导的系统（比如Windows）请务必不要把引导分区格式化，否则会导致原来的系统无法进入！</p>\n</blockquote>\n</div>\n\n<div class=\"info\">\n\n\n\n<blockquote>\n<p>设引导分区为 &#x2F;dev&#x2F;sda1，系统分区为 &#x2F;dev&#x2F;sda2</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkfs.ext4 /dev/sda2 <span class=\"comment\"># 格式化 /dev/sda2 为 ext4 文件系统（系统分区或用户资料分区）</span></span><br><span class=\"line\">mkfs.vfat /dev/sda1 <span class=\"comment\"># 格式化 /dev/sda1 为 FAT32 文件系统（引导分区）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"挂载分区\"><a href=\"#挂载分区\" class=\"headerlink\" title=\"挂载分区\"></a>挂载分区</h2><h3 id=\"GPT\"><a href=\"#GPT\" class=\"headerlink\" title=\"GPT\"></a>GPT</h3><div class=\"info\">\n\n\n\n<blockquote>\n<p>设引导分区为 &#x2F;dev&#x2F;sda1，系统分区为 &#x2F;dev&#x2F;sda2，用户资料分区为&#x2F;dev&#x2F;sda3</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount /dev/sda2 /mnt <span class=\"comment\"># 挂载系统分区到 /mnt( / 分区)</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /mnt/boot /mnt/home <span class=\"comment\"># 新建 /mnt/boot 文件夹和 /mnt/home 文件夹</span></span><br><span class=\"line\">mount /dev/sda1 /mnt/boot <span class=\"comment\"># 挂载引导分区到 /mnt/boot</span></span><br><span class=\"line\">mount /dev/sda3 /mnt/home <span class=\"comment\"># 挂载用户资料分区到 /mnt/home （ /home 分区，在有用户资料分区的情况下才执行）</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MBR\"><a href=\"#MBR\" class=\"headerlink\" title=\"MBR\"></a>MBR</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount /dev/sda1 /mnt  <span class=\"comment\"># 挂载系统分区到 /mnt( / 分区)</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /mnt/home <span class=\"comment\"># 创建 /mnt/home 文件夹</span></span><br><span class=\"line\">mount /dev/sda2 /mnt/home <span class=\"comment\"># 挂载用户资料分区到 /mnt/home( /home 分区，在有用户资料分区的情况下才执行)</span></span><br></pre></td></tr></table></figure>\n\n<p>（以上文段参考了<a href=\"https://chitang.tech/posts/arch-guide/#%E6%8C%82%E8%BD%BD\">Chi_Tang的博客</a>并进行修改）</p>\n<h2 id=\"安装本体到硬盘\"><a href=\"#安装本体到硬盘\" class=\"headerlink\" title=\"安装本体到硬盘\"></a>安装本体到硬盘</h2><h3 id=\"使用中国的-nix-channel\"><a href=\"#使用中国的-nix-channel\" class=\"headerlink\" title=\"使用中国的 nix-channel\"></a>使用中国的 nix-channel</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nix-channel --add https://mirrors.ustc.edu.cn/nix-channels/nixos-unstable nixos</span><br><span class=\"line\">nix-channel --update</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"生成配置文件\"><a href=\"#生成配置文件\" class=\"headerlink\" title=\"生成配置文件\"></a>生成配置文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># nixos-generate-config --root /mnt</span></span><br></pre></td></tr></table></figure>\n\n<p>该命令会生成配置文件到<code>/mnt/etc/nixos/</code>目录中，里面包括了硬件配置文件(<code>hardware-configuration.nix</code>)和<code>configuration.nix</code></p>\n<p>如果你有自己配置好的<code>configuration.nix</code>只要替换掉即可</p>\n<blockquote>\n<p>提示：在修改 NixOS 配置文件的时候要注意缩进及分号 <code>;</code> 的使用。<code>configuration.nix</code> 当中已经存在一些默认配置好的语句，可以参考它们的格式。</p>\n</blockquote>\n<h3 id=\"更改配置文件\"><a href=\"#更改配置文件\" class=\"headerlink\" title=\"更改配置文件\"></a>更改配置文件</h3><blockquote>\n<p>「古人云：『知其然，知其所以然。（宋・朱熹《建宁府建阳县长滩社仓记》）』意思是说，在知道事物的表面现象的同时，更应去探明事物的本质及其产生的原因。同样的道理可以应用在 Nix 上。在配置 NixOS 的时候，总抄作业可不是好习惯。抄袭其他人的配置文件能够满足用户一时的使用，但此时的用户仍然没有了解 Nix 的设置方法，当用户真正有自己需求的时候，仍然不知该怎么做。相比起抄袭其他人配置文件，我更希望用户阅读 NixOS 自带的手册 NixOS Manual，以及在 <a href=\"search.nixos.org\">search.nixos.org</a> 上查询软件包名（Packages）和配置语句（Options）。这样，用户能真正学到 NixOS 独特的声明式配置方式的精髓。」 ——<a href=\"github.con/YisuiDenghua\">一穗灯花</a></p>\n</blockquote>\n<p>使用vim开始编辑</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /mnt/etc/nixos/configuration.nix</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"允许安装不自由的软件\"><a href=\"#允许安装不自由的软件\" class=\"headerlink\" title=\"允许安装不自由的软件\"></a>允许安装不自由的软件</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixpkgs.config.<span class=\"attr\">allowUnfree</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-15.png\"></p>\n<h4 id=\"安装NotoFonts字体以显示中文和其他特殊字符\"><a href=\"#安装NotoFonts字体以显示中文和其他特殊字符\" class=\"headerlink\" title=\"安装NotoFonts字体以显示中文和其他特殊字符\"></a>安装NotoFonts字体以显示中文和其他特殊字符</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fonts.<span class=\"attr\">fonts</span> = <span class=\"keyword\">with</span> pkgs; [</span><br><span class=\"line\">  noto-fonts</span><br><span class=\"line\">  noto-fonts-cjk</span><br><span class=\"line\">  noto-fonts-emoji</span><br><span class=\"line\">  meslo-lgs-nf</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-16.png\"></p>\n<h4 id=\"设置时区\"><a href=\"#设置时区\" class=\"headerlink\" title=\"设置时区\"></a>设置时区</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">time.<span class=\"attr\">timeZone</span> = <span class=\"string\">&quot;Asia/Shanghai&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-16_1.png\"></p>\n<h4 id=\"使用NetworkManager联网\"><a href=\"#使用NetworkManager联网\" class=\"headerlink\" title=\"使用NetworkManager联网\"></a>使用NetworkManager联网</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">networking.networkmanager.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://pic.lanta.cyou/img/20220506104638.png\"></p>\n<h4 id=\"设置中文\"><a href=\"#设置中文\" class=\"headerlink\" title=\"设置中文\"></a>设置中文</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i18n.<span class=\"attr\">defaultLocale</span> = <span class=\"string\">&quot;zh_CN.UTF-8&quot;</span>;</span><br><span class=\"line\">i18n.inputMethod.<span class=\"attr\">enabled</span> = <span class=\"string\">&quot;fcitx5&quot;</span>;</span><br><span class=\"line\">i18n.inputMethod.fcitx5.<span class=\"attr\">addons</span> = <span class=\"keyword\">with</span> pkgs; [ fcitx5-rime ];</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：这里使用 <code>fcitx5-rime </code>作为示例。用户可以将其替换为 <code>fcitx5-chinese-addons</code> 等其他输入法。</p>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-19.png\"></p>\n<h4 id=\"设置桌面环境\"><a href=\"#设置桌面环境\" class=\"headerlink\" title=\"设置桌面环境\"></a>设置桌面环境</h4><p>如果你使用的是Plasma，那么生成配置文件的时候会自动帮你设置好Plasma，Gnome用户同理。这里以 KDE Plasma 和 GNU GNOME 为例：</p>\n<div class=\"warning\">\n\n<blockquote>\n<p>警告：在 NixOS 上，无法同时启用 GNOME 和 KDE Plasma。</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 如果要使用 GNOME：</span></span><br><span class=\"line\">services.xserver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.displayManager.gdm.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.desktopManager.gnome.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 如果要使用 KDE Plasma</span></span><br><span class=\"line\">services.xserver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.displayManager.sddm.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.desktopManager.plasma5.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：如果想要启用 Plasma 的 Qt 缩放，你还需要添加一条语句：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.desktopManager.plasma5.useQtScaling = true;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-20.png\"></p>\n<h4 id=\"设置普通用户\"><a href=\"#设置普通用户\" class=\"headerlink\" title=\"设置普通用户\"></a>设置普通用户</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">users.users.&lt;用户名&gt; = &#123;</span><br><span class=\"line\">  <span class=\"attr\">isNormalUser</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"attr\">shell</span> = pkgs.zsh;</span><br><span class=\"line\">  <span class=\"attr\">extraGroups</span> = [ <span class=\"string\">&quot;wheel&quot;</span> ]; <span class=\"comment\"># Enable ‘sudo’ for the user.</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示，如果你的用户要使用图形界面，你还需要将 <code>&quot;video&quot;</code> 加入到  <code>extraGroups = [  ];  </code> 当中；如果你的用户要使用 <code>docker</code>，你还需要将<code>&quot;docker&quot;</code>加入语句中。如果你不想给用户使用 <code>sudo</code> 的权利，将  <code>&quot;wheel&quot; </code> 从上述语句中移除。</p>\n</blockquote>\n<p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-22.png\"></p>\n<h4 id=\"设置安装的软件\"><a href=\"#设置安装的软件\" class=\"headerlink\" title=\"设置安装的软件\"></a>设置安装的软件</h4><p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-25.png\"></p>\n<h4 id=\"开启SSH（可选）\"><a href=\"#开启SSH（可选）\" class=\"headerlink\" title=\"开启SSH（可选）\"></a>开启SSH（可选）</h4><p><img src=\"https://pic.lanta.cyou/img/2022-05-06_10-26.png\"></p>\n<h3 id=\"提示：用户的特殊需求\"><a href=\"#提示：用户的特殊需求\" class=\"headerlink\" title=\"提示：用户的特殊需求\"></a>提示：用户的特殊需求</h3><p>对于某些有特殊需求的用户，需要在安装之前按需修改配置文件。</p>\n<h4 id=\"使用-NUR\"><a href=\"#使用-NUR\" class=\"headerlink\" title=\"使用 NUR\"></a>使用 NUR</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixpkgs.config.packageOverrides = pkgs: &#123;</span><br><span class=\"line\">  nur = import (builtins.fetchTarball &quot;https://github.com/nix-community/NUR/archive/master.tar.gz&quot;) &#123;</span><br><span class=\"line\">    inherit pkgs;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;;  </span><br><span class=\"line\">  </span><br></pre></td></tr></table></figure>\n\n<p>而后，可以在 <a href=\"https://nur.nix-community.org/\">https://nur.nix-community.org/</a> 上搜索 NUR 软件包，例如微信。然后，可以使用声明式的方式安装：</p>\n<p><img src=\"https://pic.lanta.cyou/img/photo_2022-05-06_13-49-27.jpg\"></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">environment.<span class=\"attr\">systemPackages</span> = <span class=\"keyword\">with</span> pkgs; [</span><br><span class=\"line\">  nur.repos.xddxdd.wechat-uos-bin</span><br><span class=\"line\"> ];</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：由于 NUR 使用 <a href=\"github.com\">GitHub</a> 来托管软件包代码，而 GitHub 在国内的某些地区连接不佳，你可能还需要在安装之前配置代理。</p>\n<p>可以通过 <code>nix-env -iA nixos.v2ray</code> 在安装 LiveCD 里临时安装 <code>v2ray</code>。对于带有 GUI 的 LiveCD，可使用 <code>nix-env -iA nixos.qv2ray</code>。在使用 <code>qv2ray</code> 的时候，需参照 <a href=\"https://qv2ray.net/lang/zh/getting-started/step2.html\">https://qv2ray.net/lang/zh/getting-started/step2.html</a> 配置其核心文件。</p>\n</blockquote>\n<h4 id=\"使用-AMD-显卡\"><a href=\"#使用-AMD-显卡\" class=\"headerlink\" title=\"使用 AMD 显卡\"></a>使用 AMD 显卡</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hardware.opengl.extraPackages = [</span><br><span class=\"line\">  rocm-opencl-icd</span><br><span class=\"line\">  pkgs.amdvlk</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Intel-Gen8-或更新的显卡\"><a href=\"#使用-Intel-Gen8-或更新的显卡\" class=\"headerlink\" title=\"使用 Intel Gen8 或更新的显卡\"></a>使用 Intel Gen8 或更新的显卡</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hardware.opengl.extraPackages = [</span><br><span class=\"line\">  intel-compute-runtime</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-NVIDIA-显卡\"><a href=\"#使用-NVIDIA-显卡\" class=\"headerlink\" title=\"使用 NVIDIA 显卡\"></a>使用 NVIDIA 显卡</h4><div class=\"warning\">\n\n<blockquote>\n<p>警告：如果你正在为 Linux 选购硬件，除非特殊需要，请避免使用由 NVIDIA，Realtek，Broadcom 以及 Apple Inc 生产的设备。在这些公司所生产的硬件设备上部署 Linux 可能会非常棘手。</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.<span class=\"attr\">videoDrivers</span> = [ <span class=\"string\">&quot;nvidia&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n<div class=\"info\">\n\n<blockquote>\n<p>提示：由于 NVIDIA 的驱动是非自由软件，你同时还需要在配置文件中使用 <code>  nixpkgs.config.allowUnfree = true;</code>启用非自由软件</p>\n</blockquote>\n</div>\n\n<h4 id=\"使用数位板\"><a href=\"#使用数位板\" class=\"headerlink\" title=\"使用数位板\"></a>使用数位板</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.xserver.wacom.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">services.xserver.digimend.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">hardware.opentabletdriver.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">hardware.opentabletdriver.daemon.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Steam\"><a href=\"#使用-Steam\" class=\"headerlink\" title=\"使用 Steam\"></a>使用 Steam</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">programs.steam.enable = true;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-AppImage\"><a href=\"#使用-AppImage\" class=\"headerlink\" title=\"使用 AppImage\"></a>使用 AppImage</h4><p>安装软件包 <code>appimage-run</code></p>\n<h4 id=\"使用为常规-Linux-而编译的二进行程序\"><a href=\"#使用为常规-Linux-而编译的二进行程序\" class=\"headerlink\" title=\"使用为常规 Linux 而编译的二进行程序\"></a>使用为常规 Linux 而编译的二进行程序</h4><p>安装软件包 <code>steam-run</code></p>\n<h4 id=\"在-NixOS-中作为宿主时使用-VirtualBox\"><a href=\"#在-NixOS-中作为宿主时使用-VirtualBox\" class=\"headerlink\" title=\"在 NixOS 中作为宿主时使用 VirtualBox\"></a>在 NixOS 中作为宿主时使用 VirtualBox</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.virtualbox.host.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">users.extraGroups.vboxusers.<span class=\"attr\">members</span> = [ <span class=\"string\">&quot;&lt;用户名&gt;&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"在-NixOS-中作为宿主时使用-KVM\"><a href=\"#在-NixOS-中作为宿主时使用-KVM\" class=\"headerlink\" title=\"在 NixOS 中作为宿主时使用 KVM\"></a>在 NixOS 中作为宿主时使用 KVM</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.libvirtd.qemu.<span class=\"attr\">package</span> = pkgs.qemu_kvm;</span><br><span class=\"line\">virtualisation.libvirtd.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用-Flatpak\"><a href=\"#使用-Flatpak\" class=\"headerlink\" title=\"使用 Flatpak\"></a>使用 Flatpak</h4><div class=\"warning\">\n\n<blockquote>\n<p>如果你这 Flatpak 安装了有中文的软件，请在 <code>~/.local/share/fonts/</code> 目录里放几个中文字体，否则中文无法正常显示</p>\n</blockquote>\n</div>\n\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">services.flatpak.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>提示：如果你使用非 GNOME 的桌面环境，你还需要配置</p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xdg.portal.<span class=\"attr\">extraPortals</span> = [ pkgs.xdg-desktop-portal-gtk ];</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>在启用 flatpak 之后，需要导入 flathub 源：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo</span><br><span class=\"line\">flatpak update</span><br></pre></td></tr></table></figure>\n<h4 id=\"开启支持-NTFS-读写\"><a href=\"#开启支持-NTFS-读写\" class=\"headerlink\" title=\"开启支持 NTFS 读写\"></a>开启支持 NTFS 读写</h4><div class=\"warning\">\n\n<blockquote>\n<p>如果你有使用 NTFS 格式的硬盘，在 <code>configuration.nix</code> 中加入以下字段来提供 NTFS 的支持</p>\n</blockquote>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.<span class=\"attr\">supportedFilesystems</span> = [ <span class=\"string\">&quot;ntfs&quot;</span> ];</span><br></pre></td></tr></table></figure>\n\n</div>\n\n<h4 id=\"使用-Docker\"><a href=\"#使用-Docker\" class=\"headerlink\" title=\"使用 Docker\"></a>使用 Docker</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualisation.docker.<span class=\"attr\">enable</span> = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<p>此外，你还需要将用户加入 “docker” 用户组</p>\n<h4 id=\"使用其他-Linux-内核\"><a href=\"#使用其他-Linux-内核\" class=\"headerlink\" title=\"使用其他 Linux 内核\"></a>使用其他 Linux 内核</h4><p><code>Packages</code> 选项来指定 NixOS 使用的内核。例如：使用 <code>linux-zen</code></p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">boot.<span class=\"attr\">kernelPackages</span> = pkgs.linuxPackages_zen;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用中国的-Nix-二进制源\"><a href=\"#使用中国的-Nix-二进制源\" class=\"headerlink\" title=\"使用中国的 Nix 二进制源\"></a>使用中国的 Nix 二进制源</h4><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nix.settings.<span class=\"attr\">substituters</span> = [ <span class=\"string\">&quot;https://mirrors.ustc.edu.cn/nix-channels/store&quot;</span> ];</span><br></pre></td></tr></table></figure>\n<div class=\"warning\">\n\n<blockquote>\n<p>注意</p>\n<p>在NixOS 21.11中，不存在 <code>nix.settings</code> 段</p>\n<p>所以如果你安装的是NixOS 21.11，要改成下面这样：</p>\n<p><code>nix.binaryCaches = [ &quot;https://mirrors.ustc.edu.cn/nix-channels/store&quot; ];</code></p>\n</blockquote>\n</div>\n\n<h3 id=\"安装-NixOS\"><a href=\"#安装-NixOS\" class=\"headerlink\" title=\"安装 NixOS\"></a>安装 NixOS</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nixos-install --root /mnt</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"重启\"><a href=\"#重启\" class=\"headerlink\" title=\"重启\"></a>重启</h2><div class=\"success\">\n\n<blockquote>\n<p>到这里，我们的LiveCD的安装步骤就完成了，曙光就在眼前了！接下来我们重启就可以进入你配置好的NixOS</p>\n</blockquote>\n</div>\n\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cl4k28bs90000trgq5h3z18jw","category_id":"cl4k28bsm0001trgq9jch4afe","_id":"cl4k28bsr0004trgq68r7hzjk"}],"PostTag":[{"post_id":"cl4k28bs90000trgq5h3z18jw","tag_id":"cl4k28bso0002trgq0bgf4tz7","_id":"cl4k28bst0006trgq1enedkw2"},{"post_id":"cl4k28bs90000trgq5h3z18jw","tag_id":"cl4k28bsq0003trgqfa4yhdtx","_id":"cl4k28bst0007trgq15n7guvp"},{"post_id":"cl4k28bs90000trgq5h3z18jw","tag_id":"cl4k28bss0005trgqhlag9l2n","_id":"cl4k28bst0008trgq0xr70dfo"}],"Tag":[{"name":"NixOS","_id":"cl4k28bso0002trgq0bgf4tz7"},{"name":"Linux","_id":"cl4k28bsq0003trgqfa4yhdtx"},{"name":"保姆级教程","_id":"cl4k28bss0005trgqhlag9l2n"}]}}